<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>teqp: include/teqp/algorithms/VLE_pure.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  loader: {
    load: ['[tex]/autoload']
  },
  tex: {
    macros: {    deriv: ["{\\left(\\frac{\\partial #1}{\\partial #2}\\right)_{#3}}",3],
    },
    packages: ['base','configmacros','newcommand','autoload']
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">teqp<span id="projectnumber">&#160;0.14.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_3db4b25fbe33360eb6f2cd11f794cfaa.html">teqp</a></li><li class="navelem"><a class="el" href="dir_066bcbd2a9db27123555c7e73ba8c0f2.html">algorithms</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">VLE_pure.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="VLE__pure_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">//</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//  VLE_pure.hpp</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">//  teqp</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">//</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">//  Created by Bell, Ian H. (Fed) on 5/3/23.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">//</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;type_traits&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &quot;<a class="code" href="teqpcpp_8hpp.html">teqp/cpp/teqpcpp.hpp</a>&quot;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &quot;<a class="code" href="derivs_8hpp.html">teqp/derivs.hpp</a>&quot;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;<a class="code" href="critical__pure_8hpp.html">teqp/algorithms/critical_pure.hpp</a>&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceteqp.html">teqp</a>{</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno"><a class="line" href="namespaceteqp.html#abf4178adee8264741ab6d892f09a05a9">   15</a></span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Model&gt; <span class="keyword">using </span><a class="code hl_typedef" href="namespaceteqp.html#abf4178adee8264741ab6d892f09a05a9">is_AbstractModel</a> = <span class="keyword">typename</span> std::is_base_of&lt;teqp::cppinterface::AbstractModel, Model&gt;;</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno"><a class="line" href="namespaceteqp.html#a3c6fcfa03eb6572863697cc040b7d75a">   16</a></span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Model&gt; <span class="keyword">using </span><a class="code hl_typedef" href="namespaceteqp.html#a3c6fcfa03eb6572863697cc040b7d75a">is_not_AbstractModel</a> = std::negation&lt;is_AbstractModel&lt;Model&gt;&gt;;</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Model, <span class="keyword">typename</span> TYPE=<span class="keywordtype">double</span>, ADBackends backend = ADBackends::autodiff&gt;</div>
<div class="foldopen" id="foldopen00019" data-start="{" data-end="};">
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html">   19</a></span><span class="keyword">class </span><a class="code hl_class" href="classteqp_1_1IsothermPureVLEResiduals.html">IsothermPureVLEResiduals</a>  {</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html#adebd07ab239cb540af4c1bd6e7d775d8">   21</a></span>    <span class="keyword">using </span><a class="code hl_typedef" href="classteqp_1_1IsothermPureVLEResiduals.html#adebd07ab239cb540af4c1bd6e7d775d8">EigenArray</a> = Eigen::Array&lt;TYPE, 2, 1&gt;;</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html#a05728307873ae454952f6c9fe36160b9">   22</a></span>    <span class="keyword">using </span><a class="code hl_typedef" href="classteqp_1_1IsothermPureVLEResiduals.html#a05728307873ae454952f6c9fe36160b9">EigenArray1</a> = Eigen::Array&lt;TYPE, 1, 1&gt;;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html#a5d27b02614e4e3b464432afb8c87006c">   23</a></span>    <span class="keyword">using </span><a class="code hl_typedef" href="classteqp_1_1IsothermPureVLEResiduals.html#a5d27b02614e4e3b464432afb8c87006c">EigenMatrix</a> = Eigen::Array&lt;TYPE, 2, 2&gt;;</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    <span class="keyword">const</span> Model&amp; m_model;</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    <span class="keyword">const</span> TYPE m_T;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    <span class="keyword">const</span> Eigen::ArrayXd molefracs;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    <a class="code hl_typedef" href="classteqp_1_1IsothermPureVLEResiduals.html#a5d27b02614e4e3b464432afb8c87006c">EigenMatrix</a> J;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    <a class="code hl_typedef" href="classteqp_1_1IsothermPureVLEResiduals.html#adebd07ab239cb540af4c1bd6e7d775d8">EigenArray</a> y;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html#a3c20b7db5499f794ccedf5e72cbfd5bd">   31</a></span>    std::size_t <a class="code hl_variable" href="classteqp_1_1IsothermPureVLEResiduals.html#a3c20b7db5499f794ccedf5e72cbfd5bd">icall</a> = 0;</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html#a07e4a107a25638922d0d289790523616">   32</a></span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="classteqp_1_1IsothermPureVLEResiduals.html#a070d854da15eae21b5c25c3fa799a5af">Rr</a>, <a class="code hl_variable" href="classteqp_1_1IsothermPureVLEResiduals.html#a07e4a107a25638922d0d289790523616">R0</a>;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="foldopen" id="foldopen00034" data-start="{" data-end="}">
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html#ad3b8d0594f4f9a1f06ca1ec99fe07bcf">   34</a></span>    <a class="code hl_function" href="classteqp_1_1IsothermPureVLEResiduals.html#ad3b8d0594f4f9a1f06ca1ec99fe07bcf">IsothermPureVLEResiduals</a>(<span class="keyword">const</span> Model&amp; model, <span class="keyword">const</span> TYPE&amp; T, <span class="keyword">const</span> std::optional&lt;Eigen::ArrayXd&gt;&amp; molefracs_ = std::nullopt) : m_model(model), m_T(T),</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>        molefracs( (molefracs_) ? molefracs_.value() : Eigen::ArrayXd::Ones(1,1)) {</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>            <span class="keywordflow">if</span> <span class="keyword">constexpr</span>(<a class="code hl_typedef" href="namespaceteqp.html#a3c6fcfa03eb6572863697cc040b7d75a">is_not_AbstractModel&lt;Model&gt;::value</a>){</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>                <a class="code hl_variable" href="classteqp_1_1IsothermPureVLEResiduals.html#a070d854da15eae21b5c25c3fa799a5af">Rr</a> = m_model.R(molefracs);</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>                <a class="code hl_variable" href="classteqp_1_1IsothermPureVLEResiduals.html#a07e4a107a25638922d0d289790523616">R0</a> = m_model.R(molefracs);</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>            }</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>            <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>                <a class="code hl_variable" href="classteqp_1_1IsothermPureVLEResiduals.html#a070d854da15eae21b5c25c3fa799a5af">Rr</a> = m_model.get_R(molefracs);</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>                <a class="code hl_variable" href="classteqp_1_1IsothermPureVLEResiduals.html#a07e4a107a25638922d0d289790523616">R0</a> = m_model.get_R(molefracs);</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>            }</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    };</div>
</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html#a3d10f6465b0f12433d5c71c30ceed272">   46</a></span>    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="classteqp_1_1IsothermPureVLEResiduals.html#a3d10f6465b0f12433d5c71c30ceed272">get_errors</a>() { <span class="keywordflow">return</span> y; };</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Rho&gt;</div>
<div class="foldopen" id="foldopen00049" data-start="{" data-end="}">
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html#a7a127622cf9f7864dca1ec8190b3a808">   49</a></span>    <span class="keyword">auto</span> <a class="code hl_function" href="classteqp_1_1IsothermPureVLEResiduals.html#a7a127622cf9f7864dca1ec8190b3a808">get_der</a>(<span class="keyword">const</span> Rho&amp; rho){</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>        <span class="keywordflow">if</span> <span class="keyword">constexpr</span>(<a class="code hl_typedef" href="namespaceteqp.html#a3c6fcfa03eb6572863697cc040b7d75a">is_not_AbstractModel&lt;Model&gt;::value</a>){</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>            <span class="keyword">using </span>tdx = <a class="code hl_struct" href="structteqp_1_1TDXDerivatives.html">TDXDerivatives&lt;Model,TYPE,Eigen::ArrayXd&gt;</a>;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>            <span class="keywordflow">return</span> tdx::template get_Ar0n&lt;2, backend&gt;(m_model, m_T, rho, molefracs);</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>        }</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>        <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>            <span class="keywordflow">return</span> m_model.get_Ar02n(m_T, rho, molefracs);</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>        }</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    }</div>
</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="foldopen" id="foldopen00059" data-start="{" data-end="}">
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html#a06f1565905a8ffe4f77de1c53433044b">   59</a></span>    <span class="keyword">auto</span> <a class="code hl_function" href="classteqp_1_1IsothermPureVLEResiduals.html#a06f1565905a8ffe4f77de1c53433044b">call</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="classteqp_1_1IsothermPureVLEResiduals.html#adebd07ab239cb540af4c1bd6e7d775d8">EigenArray</a>&amp; rhovec) {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        assert(rhovec.size() == 2);</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classteqp_1_1IsothermPureVLEResiduals.html#a05728307873ae454952f6c9fe36160b9">EigenArray1</a> rhovecL = rhovec.head(1);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="classteqp_1_1IsothermPureVLEResiduals.html#a05728307873ae454952f6c9fe36160b9">EigenArray1</a> rhovecV = rhovec.tail(1);</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>        <span class="keyword">const</span> <span class="keyword">auto</span> rhomolarL = rhovecL.sum(), rhomolarV = rhovecV.sum();</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>        <span class="comment">//const TYPE R = m_model.R(molefracs);</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>        <span class="keywordtype">double</span> R0_over_Rr = <a class="code hl_variable" href="classteqp_1_1IsothermPureVLEResiduals.html#a07e4a107a25638922d0d289790523616">R0</a> / <a class="code hl_variable" href="classteqp_1_1IsothermPureVLEResiduals.html#a070d854da15eae21b5c25c3fa799a5af">Rr</a>;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>        </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>        <span class="keyword">auto</span> derL = <a class="code hl_function" href="classteqp_1_1IsothermPureVLEResiduals.html#a7a127622cf9f7864dca1ec8190b3a808">get_der</a>(rhomolarL);</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        <span class="keyword">auto</span> pRTL = rhomolarL*(R0_over_Rr + derL[1]); <span class="comment">// p/(R*T)</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>        <span class="keyword">auto</span> dpRTLdrhoL = R0_over_Rr + 2*derL[1] + derL[2];</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>        <span class="keyword">auto</span> hatmurL = derL[1] + derL[0] + R0_over_Rr*log(rhomolarL);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        <span class="keyword">auto</span> dhatmurLdrho = (2*derL[1] + derL[2])/rhomolarL + R0_over_Rr/rhomolarL;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        <span class="keyword">auto</span> derV = <a class="code hl_function" href="classteqp_1_1IsothermPureVLEResiduals.html#a7a127622cf9f7864dca1ec8190b3a808">get_der</a>(rhomolarV);</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        <span class="keyword">auto</span> pRTV = rhomolarV*(R0_over_Rr + derV[1]); <span class="comment">// p/(R*T)</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        <span class="keyword">auto</span> dpRTVdrhoV = R0_over_Rr + 2*derV[1] + derV[2];</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        <span class="keyword">auto</span> hatmurV = derV[1] + derV[0] + R0_over_Rr *log(rhomolarV);</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        <span class="keyword">auto</span> dhatmurVdrho = (2*derV[1] + derV[2])/rhomolarV + R0_over_Rr/rhomolarV;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        y(0) = pRTL - pRTV;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>        J(0, 0) = dpRTLdrhoL;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>        J(0, 1) = -dpRTVdrhoV;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        y(1) = hatmurL - hatmurV;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        J(1, 0) = dhatmurLdrho;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        J(1, 1) = -dhatmurVdrho;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        <a class="code hl_variable" href="classteqp_1_1IsothermPureVLEResiduals.html#a3c20b7db5499f794ccedf5e72cbfd5bd">icall</a>++;</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>        <span class="keywordflow">return</span> y;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    }</div>
</div>
<div class="foldopen" id="foldopen00092" data-start="{" data-end="}">
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="classteqp_1_1IsothermPureVLEResiduals.html#aba765806d3c27687e08c652002fadb39">   92</a></span>    <span class="keyword">auto</span> <a class="code hl_function" href="classteqp_1_1IsothermPureVLEResiduals.html#aba765806d3c27687e08c652002fadb39">Jacobian</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="classteqp_1_1IsothermPureVLEResiduals.html#adebd07ab239cb540af4c1bd6e7d775d8">EigenArray</a>&amp; rhovec){</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <span class="keywordflow">return</span> J;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    }</div>
</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <span class="comment">//auto numJacobian(const EigenArray&amp; rhovec) {</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="comment">//    EigenArray plus0 = rhovec, plus1 = rhovec;</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    <span class="comment">//    double dr = 1e-6 * rhovec[0];</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <span class="comment">//    plus0[0] += dr; plus1[1] += dr;</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    <span class="comment">//    EigenMatrix J;</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <span class="comment">//    J.col(0) = (call(plus0) - call(rhovec))/dr;</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <span class="comment">//    J.col(1) = (call(plus1) - call(rhovec))/dr;</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <span class="comment">//    return J;</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <span class="comment">//}</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>};</div>
</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Res<span class="keywordtype">id</span>ual, <span class="keyword">typename</span> Scalar=<span class="keywordtype">double</span>&gt;</div>
<div class="foldopen" id="foldopen00107" data-start="{" data-end="}">
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="namespaceteqp.html#a403c09e2eab732de1e77faec4b50863a">  107</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespaceteqp.html#a403c09e2eab732de1e77faec4b50863a">do_pure_VLE_T</a>(Residual &amp;resid, Scalar rhoL, Scalar rhoV, <span class="keywordtype">int</span> maxiter) {</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    <span class="keyword">using </span>EArray = Eigen::Array&lt;Scalar, 2, 1&gt;;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <span class="keyword">auto</span> rhovec = (EArray() &lt;&lt; rhoL, rhoV).finished();</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <span class="keyword">auto</span> r0 = resid.call(rhovec);</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    <span class="keyword">auto</span> J = resid.Jacobian(rhovec);</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = 0; iter &lt; maxiter; ++iter){</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        <span class="keywordflow">if</span> (iter &gt; 0) {</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>            r0 = resid.call(rhovec);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            J = resid.Jacobian(rhovec);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        }</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        <span class="keyword">auto</span> v = J.matrix().colPivHouseholderQr().solve(-r0.matrix()).array().eval();</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        <span class="keyword">auto</span> rhovecnew = (rhovec + v).eval();</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>        <span class="comment">//double r00 = static_cast&lt;double&gt;(r0[0]);</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        <span class="comment">//double r01 = static_cast&lt;double&gt;(r0[1]);</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>        <span class="comment">// If the solution has stopped improving, stop. The change in rhovec is equal to v in infinite precision, but</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        <span class="comment">// not when finite precision is involved, use the minimum non-denormal float as the determination of whether</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>        <span class="comment">// the values are done changing</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>        <span class="keyword">auto</span> minval = std::numeric_limits&lt;Scalar&gt;::epsilon();</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>        <span class="comment">//double minvaldbl = static_cast&lt;double&gt;(minval);</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>        <span class="keywordflow">if</span> (((rhovecnew - rhovec).cwiseAbs() &lt; minval).all()) {</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        }</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>        <span class="keywordflow">if</span> ((r0.cwiseAbs() &lt; minval).all()) {</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>        }</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>        rhovec = rhovecnew;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    }</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="keywordflow">return</span> rhovec;</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>}</div>
</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="foldopen" id="foldopen00138" data-start="{" data-end="}">
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno"><a class="line" href="namespaceteqp.html#a92911152e3677223eedb7045a0b224b1">  138</a></span><span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code hl_function" href="namespaceteqp.html#a92911152e3677223eedb7045a0b224b1">pure_VLE_T</a>(<span class="keyword">const</span> <a class="code hl_class" href="classteqp_1_1cppinterface_1_1AbstractModel.html">teqp::cppinterface::AbstractModel</a>&amp; model, <span class="keywordtype">double</span> T, <span class="keywordtype">double</span> rhoL, <span class="keywordtype">double</span> rhoV, <span class="keywordtype">int</span> maxiter, <span class="keyword">const</span> std::optional&lt;Eigen::ArrayXd&gt;&amp; molefracs = std::nullopt) {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    Eigen::ArrayXd molefracs_{Eigen::ArrayXd::Ones(1,1)};</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="keywordflow">if</span> (molefracs){ molefracs_ = molefracs.value(); }</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="keyword">auto</span> res = <a class="code hl_class" href="classteqp_1_1IsothermPureVLEResiduals.html">IsothermPureVLEResiduals&lt;teqp::cppinterface::AbstractModel&gt;</a>(model, T, molefracs_);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespaceteqp.html#a403c09e2eab732de1e77faec4b50863a">do_pure_VLE_T</a>(res, rhoL, rhoV, maxiter);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>}</div>
</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span><span class="comment">/***</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span><span class="comment"> * \brief Calculate the derivative of vapor pressure with respect to temperature</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span><span class="comment"> * \param model The model to operate on</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span><span class="comment"> * \param T Temperature</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span><span class="comment"> * \param rhoL Liquid density</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span><span class="comment"> * \param rhoV Vapor density</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span><span class="comment"> *</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span><span class="comment"> *  Based upon</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="comment"> *  \f[</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span><span class="comment"> * \frac{dp_{\sigma}}{dT} = \frac{h&#39;&#39;-h&#39;}{T(v&#39;&#39;-v&#39;)} = \frac{s&#39;&#39;-s&#39;}{v&#39;&#39;-v&#39;}</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span><span class="comment"> *  \f]</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span><span class="comment"> *  where the \f$h&#39;&#39;-h&#39;\f$ is given by the difference in residual enthalpy \f$h&#39;&#39;-h&#39; = h^r&#39;&#39;-h^r&#39;\f$ because the ideal-gas parts cancel</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen00158" data-start="{" data-end="}">
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno"><a class="line" href="namespaceteqp.html#a725528c9f3af447069508a622b26c84d">  158</a></span><span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code hl_function" href="namespaceteqp.html#a725528c9f3af447069508a622b26c84d">dpsatdT_pure</a>(<span class="keyword">const</span> <a class="code hl_class" href="classteqp_1_1cppinterface_1_1AbstractModel.html">teqp::cppinterface::AbstractModel</a>&amp; model, <span class="keywordtype">double</span> T, <span class="keywordtype">double</span> rhoL, <span class="keywordtype">double</span> rhoV, <span class="keyword">const</span> std::optional&lt;Eigen::ArrayXd&gt;&amp; molefracs = std::nullopt) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    </div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <span class="keyword">auto</span> molefrac = (Eigen::ArrayXd(1) &lt;&lt; 1.0).finished();</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <span class="keywordflow">if</span> (molefracs){ molefrac = molefracs.value(); }</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <span class="keyword">auto</span> R = model.<a class="code hl_function" href="classteqp_1_1cppinterface_1_1AbstractModel.html#a38884acb6a2663fe18967760e9438b68">get_R</a>(molefrac);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <span class="keyword">auto</span> hrVLERTV = model.<a class="code hl_function" href="classteqp_1_1cppinterface_1_1AbstractModel.html#a0ce44e70fa200a4a1480d826d23ec016">get_Ar01</a>(T, rhoV, molefrac) + model.<a class="code hl_function" href="classteqp_1_1cppinterface_1_1AbstractModel.html#a724304058e7283aa8c1877817bff9820">get_Ar10</a>(T, rhoV, molefrac);</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <span class="keyword">auto</span> hrVLERTL = model.<a class="code hl_function" href="classteqp_1_1cppinterface_1_1AbstractModel.html#a0ce44e70fa200a4a1480d826d23ec016">get_Ar01</a>(T, rhoL, molefrac) + model.<a class="code hl_function" href="classteqp_1_1cppinterface_1_1AbstractModel.html#a724304058e7283aa8c1877817bff9820">get_Ar10</a>(T, rhoL, molefrac);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <span class="keyword">auto</span> deltahr_over_T = R*(hrVLERTV-hrVLERTL);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    <span class="keyword">auto</span> dpsatdT = deltahr_over_T/(1/rhoV-1/rhoL); <span class="comment">// From Clapeyron; dp/dT = Deltas/Deltav = Deltah/(T*Deltav); Delta=V-L</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    <span class="keywordflow">return</span> dpsatdT;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>}</div>
</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span><span class="comment">/***</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span><span class="comment"> \brief Starting at the critical point, trace the VLE down to a temperature of interest</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span><span class="comment"> </span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span><span class="comment"> \note This method only works for well-behaved EOS, notably absent from that category are EOS in the multiparameter category with orthobaric scaling exponent not equal to 0.5 at the critical point. Most other analytical EOS work fine</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span><span class="comment"> </span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span><span class="comment"> The JSON data structure defines the variables that need to be specified.</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span><span class="comment"> </span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span><span class="comment"> In the current implementation, there are a few steps:</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span><span class="comment"> 1. Solve for the true critical point satisfying \f$(\partial p/\partial \rho)_{T}=(\partial^2p/\partial\rho^2)_{T}=0\f$</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span><span class="comment"> 2. Take a small step away from the critical point (this is where the beta=0.5 assumption is invoked)</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span><span class="comment"> 3. Integrate from the near critical temperature to the temperature of interest</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span><span class="comment"> */</span></div>
<div class="foldopen" id="foldopen00184" data-start="{" data-end="}">
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno"><a class="line" href="namespaceteqp.html#a2408f7de3e451a2f68a0919f821df98e">  184</a></span><span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code hl_function" href="namespaceteqp.html#a2408f7de3e451a2f68a0919f821df98e">pure_trace_VLE</a>(<span class="keyword">const</span> <a class="code hl_class" href="classteqp_1_1cppinterface_1_1AbstractModel.html">teqp::cppinterface::AbstractModel</a>&amp; model, <span class="keyword">const</span> <span class="keywordtype">double</span> T, <span class="keyword">const</span> nlohmann::json &amp;spec){</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="comment">// Start at the true critical point, from the specified guess value</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    nlohmann::json pure_spec;</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    Eigen::ArrayXd z{Eigen::ArrayXd::Ones(1,1)};</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="keywordflow">if</span> (spec.contains(<span class="stringliteral">&quot;pure_spec&quot;</span>)){</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>        pure_spec = spec.at(<span class="stringliteral">&quot;pure_spec&quot;</span>);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        z = Eigen::ArrayXd(pure_spec.at(<span class="stringliteral">&quot;alternative_length&quot;</span>).get&lt;<span class="keywordtype">int</span>&gt;()); z.setZero();</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        z(pure_spec.at(<span class="stringliteral">&quot;alternative_pure_index&quot;</span>).get&lt;<span class="keywordtype">int</span>&gt;()) = 1;</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    }</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="keyword">auto</span> [Tc, rhoc] = <a class="code hl_function" href="namespaceteqp.html#a582c949fe26e5a5c2605613c73a3c73b">solve_pure_critical</a>(model, spec.at(<span class="stringliteral">&quot;Tcguess&quot;</span>).get&lt;<span class="keywordtype">double</span>&gt;(), spec.at(<span class="stringliteral">&quot;rhocguess&quot;</span>).get&lt;<span class="keywordtype">double</span>&gt;(), pure_spec);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    <span class="comment">// Small step towards lower temperature close to critical temperature</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="keywordtype">double</span> Tclose = spec.at(<span class="stringliteral">&quot;Tred&quot;</span>).get&lt;<span class="keywordtype">double</span>&gt;()*Tc;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="keyword">auto</span> rhoLrhoV = <a class="code hl_function" href="namespaceteqp.html#a5fdf71d9e1ef7e3c69e2410aff33fa21">extrapolate_from_critical</a>(model, Tc, rhoc, Tclose, z);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    <span class="keyword">auto</span> rhoLrhoVpolished = <a class="code hl_function" href="namespaceteqp.html#a92911152e3677223eedb7045a0b224b1">pure_VLE_T</a>(model, Tclose, rhoLrhoV[0], rhoLrhoV[1], spec.value(<span class="stringliteral">&quot;NVLE&quot;</span>, 10), z);</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="keywordflow">if</span> (rhoLrhoVpolished[0] == rhoLrhoVpolished[1]){</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        <span class="keywordflow">throw</span> <a class="code hl_typedef" href="namespaceteqp.html#a10145ce83657c36965b09f8aa745378d">teqp::IterationError</a>(<span class="stringliteral">&quot;Converged to trivial solution&quot;</span>);</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    }</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <span class="comment">// &quot;Integrate&quot; down to temperature of interest</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="keywordtype">int</span> Nstep = spec.at(<span class="stringliteral">&quot;Nstep&quot;</span>);</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <span class="keywordtype">double</span> R = model.<a class="code hl_function" href="classteqp_1_1cppinterface_1_1AbstractModel.html#a99bbc2867086abea27fd27f166e984d3">R</a>(z);</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    <span class="keywordtype">bool</span> with_deriv = spec.at(<span class="stringliteral">&quot;with_deriv&quot;</span>);</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="keywordtype">double</span> dT = -(Tclose-T)/(Nstep-1);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    </div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> T_: Eigen::ArrayXd::LinSpaced(Nstep, Tclose, T)){</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        rhoLrhoVpolished = <a class="code hl_function" href="namespaceteqp.html#a92911152e3677223eedb7045a0b224b1">pure_VLE_T</a>(model, T_, rhoLrhoVpolished[0], rhoLrhoVpolished[1], spec.value(<span class="stringliteral">&quot;NVLE&quot;</span>, 10), z);</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        <span class="comment">//auto pL = rhoLrhoVpolished[0]*R*T_*(1 + tdx::get_Ar01(model, T_, rhoLrhoVpolished[0], z));</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        <span class="comment">//auto pV = rhoLrhoVpolished[1]*R*T_*(1 + tdx::get_Ar01(model, T_, rhoLrhoVpolished[1], z));</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>        <span class="comment">//std::cout &lt;&lt; pL &lt;&lt; &quot; &quot; &lt;&lt; pV &lt;&lt; &quot; &quot; &lt;&lt; pL/pV-1 &lt;&lt;  std::endl;</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>        <span class="keywordflow">if</span> (with_deriv){</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>            <span class="comment">// Get drho/dT for both phases</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>            <span class="keyword">auto</span> dpsatdT = <a class="code hl_function" href="namespaceteqp.html#a725528c9f3af447069508a622b26c84d">dpsatdT_pure</a>(model, T_, rhoLrhoVpolished[0], rhoLrhoVpolished[1], z);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>            <span class="keyword">auto</span> get_drhodT = [&amp;z, R, dpsatdT](<span class="keyword">const</span> <a class="code hl_class" href="classteqp_1_1cppinterface_1_1AbstractModel.html">AbstractModel</a>&amp; model, <span class="keywordtype">double</span> T, <span class="keywordtype">double</span> rho){</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>                <span class="keyword">auto</span> dpdrho = R*T*(1 + 2*model.get_Ar01(T, rho, z) + model.get_Ar02(T, rho, z));</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>                <span class="keyword">auto</span> dpdT = R*rho*(1 + model.get_Ar01(T, rho, z) - model.get_Ar11(T, rho, z));</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>                <span class="keywordflow">return</span> -dpdT/dpdrho + dpsatdT/dpdrho;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            };</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>            <span class="keyword">auto</span> drhodTL = get_drhodT(model, T_, rhoLrhoVpolished[0]);</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>            <span class="keyword">auto</span> drhodTV = get_drhodT(model, T_, rhoLrhoVpolished[1]);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>            <span class="comment">// Use the obtained derivative to calculate the step in rho from deltarho = (drhodT)*dT</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            <span class="keyword">auto</span> DeltarhoL = dT*drhodTL, DeltarhoV = dT*drhodTV;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            rhoLrhoVpolished[0] += DeltarhoL;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>            rhoLrhoVpolished[1] += DeltarhoV;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        }</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        <span class="comment">// Updated values for densities at new T</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        <span class="keywordflow">if</span> (!std::isfinite(rhoLrhoVpolished[0])){</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>            <span class="keywordflow">throw</span> <a class="code hl_typedef" href="namespaceteqp.html#a10145ce83657c36965b09f8aa745378d">teqp::IterationError</a>(<span class="stringliteral">&quot;The density is no longer valid; try increasing Nstep&quot;</span>);</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        }</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        <span class="keywordflow">if</span> (rhoLrhoVpolished[0] == rhoLrhoVpolished[1]){</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>            <span class="keywordflow">throw</span> <a class="code hl_typedef" href="namespaceteqp.html#a10145ce83657c36965b09f8aa745378d">teqp::IterationError</a>(<span class="stringliteral">&quot;Converged to trivial solution; try increasing Nstep&quot;</span>);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        }</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    }</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="keywordflow">return</span> rhoLrhoVpolished;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>}</div>
</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="foldopen" id="foldopen00243" data-start="" data-end="">
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno"><a class="line" href="VLE__pure_8hpp.html#a3b413f8df15578cc653d9ca2dd045d06">  243</a></span><span class="preprocessor">#define VLE_PURE_FUNCTIONS_TO_WRAP \</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span><span class="preprocessor">    X(dpsatdT_pure) \</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span><span class="preprocessor">    X(pure_VLE_T) \</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span><span class="preprocessor">    X(pure_trace_VLE)</span></div>
</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span> </div>
<div class="foldopen" id="foldopen00248" data-start="" data-end="">
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno"><a class="line" href="VLE__pure_8hpp.html#a3e0ee787dc4704f51dcecb65616b234f">  248</a></span><span class="preprocessor">#define X(f) template &lt;typename TemplatedModel, typename ...Params, \</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span><span class="preprocessor">typename = typename std::enable_if&lt;is_not_AbstractModel&lt;TemplatedModel&gt;::value&gt;::type&gt; \</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span><span class="preprocessor">inline auto f(const TemplatedModel&amp; model, Params&amp;&amp;... params){ \</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span><span class="preprocessor">    auto view = teqp::cppinterface::adapter::make_cview(model); \</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span><span class="preprocessor">    const AbstractModel&amp; am = *view.get(); \</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span><span class="preprocessor">    return f(am, std::forward&lt;Params&gt;(params)...); \</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span><span class="preprocessor">}</span></div>
</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno"><a class="line" href="namespaceteqp.html#ac53b2168b7749cca0f41c93e58cd2cdf">  255</a></span><a class="code hl_define" href="VLE__pure_8hpp.html#a3b413f8df15578cc653d9ca2dd045d06">VLE_PURE_FUNCTIONS_TO_WRAP</a></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="preprocessor">#undef X</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span><span class="preprocessor">#undef VLE_PURE_FUNCTIONS_TO_WRAP</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>}</div>
<div class="ttc" id="aVLE__pure_8hpp_html_a3b413f8df15578cc653d9ca2dd045d06"><div class="ttname"><a href="VLE__pure_8hpp.html#a3b413f8df15578cc653d9ca2dd045d06">VLE_PURE_FUNCTIONS_TO_WRAP</a></div><div class="ttdeci">#define VLE_PURE_FUNCTIONS_TO_WRAP</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00243">VLE_pure.hpp:243</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html">teqp::IsothermPureVLEResiduals</a></div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00019">VLE_pure.hpp:19</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_a05728307873ae454952f6c9fe36160b9"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#a05728307873ae454952f6c9fe36160b9">teqp::IsothermPureVLEResiduals::EigenArray1</a></div><div class="ttdeci">Eigen::Array&lt; TYPE, 1, 1 &gt; EigenArray1</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00022">VLE_pure.hpp:22</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_a06f1565905a8ffe4f77de1c53433044b"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#a06f1565905a8ffe4f77de1c53433044b">teqp::IsothermPureVLEResiduals::call</a></div><div class="ttdeci">auto call(const EigenArray &amp;rhovec)</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00059">VLE_pure.hpp:59</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_a070d854da15eae21b5c25c3fa799a5af"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#a070d854da15eae21b5c25c3fa799a5af">teqp::IsothermPureVLEResiduals::Rr</a></div><div class="ttdeci">double Rr</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00032">VLE_pure.hpp:32</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_a07e4a107a25638922d0d289790523616"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#a07e4a107a25638922d0d289790523616">teqp::IsothermPureVLEResiduals::R0</a></div><div class="ttdeci">double R0</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00032">VLE_pure.hpp:32</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_a3c20b7db5499f794ccedf5e72cbfd5bd"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#a3c20b7db5499f794ccedf5e72cbfd5bd">teqp::IsothermPureVLEResiduals::icall</a></div><div class="ttdeci">std::size_t icall</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00031">VLE_pure.hpp:31</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_a3d10f6465b0f12433d5c71c30ceed272"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#a3d10f6465b0f12433d5c71c30ceed272">teqp::IsothermPureVLEResiduals::get_errors</a></div><div class="ttdeci">const auto &amp; get_errors()</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00046">VLE_pure.hpp:46</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_a5d27b02614e4e3b464432afb8c87006c"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#a5d27b02614e4e3b464432afb8c87006c">teqp::IsothermPureVLEResiduals::EigenMatrix</a></div><div class="ttdeci">Eigen::Array&lt; TYPE, 2, 2 &gt; EigenMatrix</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00023">VLE_pure.hpp:23</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_a7a127622cf9f7864dca1ec8190b3a808"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#a7a127622cf9f7864dca1ec8190b3a808">teqp::IsothermPureVLEResiduals::get_der</a></div><div class="ttdeci">auto get_der(const Rho &amp;rho)</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00049">VLE_pure.hpp:49</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_aba765806d3c27687e08c652002fadb39"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#aba765806d3c27687e08c652002fadb39">teqp::IsothermPureVLEResiduals::Jacobian</a></div><div class="ttdeci">auto Jacobian(const EigenArray &amp;rhovec)</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00092">VLE_pure.hpp:92</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_ad3b8d0594f4f9a1f06ca1ec99fe07bcf"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#ad3b8d0594f4f9a1f06ca1ec99fe07bcf">teqp::IsothermPureVLEResiduals::IsothermPureVLEResiduals</a></div><div class="ttdeci">IsothermPureVLEResiduals(const Model &amp;model, const TYPE &amp;T, const std::optional&lt; Eigen::ArrayXd &gt; &amp;molefracs_=std::nullopt)</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00034">VLE_pure.hpp:34</a></div></div>
<div class="ttc" id="aclassteqp_1_1IsothermPureVLEResiduals_html_adebd07ab239cb540af4c1bd6e7d775d8"><div class="ttname"><a href="classteqp_1_1IsothermPureVLEResiduals.html#adebd07ab239cb540af4c1bd6e7d775d8">teqp::IsothermPureVLEResiduals::EigenArray</a></div><div class="ttdeci">Eigen::Array&lt; TYPE, 2, 1 &gt; EigenArray</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00021">VLE_pure.hpp:21</a></div></div>
<div class="ttc" id="aclassteqp_1_1cppinterface_1_1AbstractModel_html"><div class="ttname"><a href="classteqp_1_1cppinterface_1_1AbstractModel.html">teqp::cppinterface::AbstractModel</a></div><div class="ttdef"><b>Definition</b> <a href="teqpcpp_8hpp_source.html#l00087">teqpcpp.hpp:87</a></div></div>
<div class="ttc" id="aclassteqp_1_1cppinterface_1_1AbstractModel_html_a0ce44e70fa200a4a1480d826d23ec016"><div class="ttname"><a href="classteqp_1_1cppinterface_1_1AbstractModel.html#a0ce44e70fa200a4a1480d826d23ec016">teqp::cppinterface::AbstractModel::get_Ar01</a></div><div class="ttdeci">virtual double get_Ar01(const double T, const double rho, const REArrayd &amp;molefrac) const =0</div></div>
<div class="ttc" id="aclassteqp_1_1cppinterface_1_1AbstractModel_html_a38884acb6a2663fe18967760e9438b68"><div class="ttname"><a href="classteqp_1_1cppinterface_1_1AbstractModel.html#a38884acb6a2663fe18967760e9438b68">teqp::cppinterface::AbstractModel::get_R</a></div><div class="ttdeci">virtual double get_R(const EArrayd &amp;) const =0</div></div>
<div class="ttc" id="aclassteqp_1_1cppinterface_1_1AbstractModel_html_a724304058e7283aa8c1877817bff9820"><div class="ttname"><a href="classteqp_1_1cppinterface_1_1AbstractModel.html#a724304058e7283aa8c1877817bff9820">teqp::cppinterface::AbstractModel::get_Ar10</a></div><div class="ttdeci">virtual double get_Ar10(const double T, const double rho, const REArrayd &amp;molefrac) const =0</div></div>
<div class="ttc" id="aclassteqp_1_1cppinterface_1_1AbstractModel_html_a99bbc2867086abea27fd27f166e984d3"><div class="ttname"><a href="classteqp_1_1cppinterface_1_1AbstractModel.html#a99bbc2867086abea27fd27f166e984d3">teqp::cppinterface::AbstractModel::R</a></div><div class="ttdeci">double R(const EArrayd &amp;x) const</div><div class="ttdef"><b>Definition</b> <a href="teqpcpp_8hpp_source.html#l00095">teqpcpp.hpp:95</a></div></div>
<div class="ttc" id="acritical__pure_8hpp_html"><div class="ttname"><a href="critical__pure_8hpp.html">critical_pure.hpp</a></div></div>
<div class="ttc" id="aderivs_8hpp_html"><div class="ttname"><a href="derivs_8hpp.html">derivs.hpp</a></div></div>
<div class="ttc" id="anamespaceteqp_html"><div class="ttname"><a href="namespaceteqp.html">teqp</a></div><div class="ttdef"><b>Definition</b> <a href="critical__pure_8hpp_source.html#l00016">critical_pure.hpp:16</a></div></div>
<div class="ttc" id="anamespaceteqp_html_a10145ce83657c36965b09f8aa745378d"><div class="ttname"><a href="namespaceteqp.html#a10145ce83657c36965b09f8aa745378d">teqp::IterationError</a></div><div class="ttdeci">IterationFailure IterationError</div><div class="ttdef"><b>Definition</b> <a href="exceptions_8hpp_source.html#l00039">exceptions.hpp:39</a></div></div>
<div class="ttc" id="anamespaceteqp_html_a2408f7de3e451a2f68a0919f821df98e"><div class="ttname"><a href="namespaceteqp.html#a2408f7de3e451a2f68a0919f821df98e">teqp::pure_trace_VLE</a></div><div class="ttdeci">auto pure_trace_VLE(const teqp::cppinterface::AbstractModel &amp;model, const double T, const nlohmann::json &amp;spec)</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00184">VLE_pure.hpp:184</a></div></div>
<div class="ttc" id="anamespaceteqp_html_a3c6fcfa03eb6572863697cc040b7d75a"><div class="ttname"><a href="namespaceteqp.html#a3c6fcfa03eb6572863697cc040b7d75a">teqp::is_not_AbstractModel</a></div><div class="ttdeci">std::negation&lt; is_AbstractModel&lt; Model &gt; &gt; is_not_AbstractModel</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00016">VLE_pure.hpp:16</a></div></div>
<div class="ttc" id="anamespaceteqp_html_a403c09e2eab732de1e77faec4b50863a"><div class="ttname"><a href="namespaceteqp.html#a403c09e2eab732de1e77faec4b50863a">teqp::do_pure_VLE_T</a></div><div class="ttdeci">auto do_pure_VLE_T(Residual &amp;resid, Scalar rhoL, Scalar rhoV, int maxiter)</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00107">VLE_pure.hpp:107</a></div></div>
<div class="ttc" id="anamespaceteqp_html_a582c949fe26e5a5c2605613c73a3c73b"><div class="ttname"><a href="namespaceteqp.html#a582c949fe26e5a5c2605613c73a3c73b">teqp::solve_pure_critical</a></div><div class="ttdeci">auto solve_pure_critical(const Model &amp;model, const Scalar T0, const Scalar rho0, const std::optional&lt; nlohmann::json &gt; &amp;flags=std::nullopt)</div><div class="ttdef"><b>Definition</b> <a href="critical__pure_8hpp_source.html#l00093">critical_pure.hpp:93</a></div></div>
<div class="ttc" id="anamespaceteqp_html_a5fdf71d9e1ef7e3c69e2410aff33fa21"><div class="ttname"><a href="namespaceteqp.html#a5fdf71d9e1ef7e3c69e2410aff33fa21">teqp::extrapolate_from_critical</a></div><div class="ttdeci">Eigen::Array&lt; double, 2, 1 &gt; extrapolate_from_critical(const Model &amp;model, const Scalar &amp;Tc, const Scalar &amp;rhoc, const Scalar &amp;T, const std::optional&lt; Eigen::ArrayXd &gt; &amp;z=std::nullopt)</div><div class="ttdef"><b>Definition</b> <a href="critical__pure_8hpp_source.html#l00181">critical_pure.hpp:181</a></div></div>
<div class="ttc" id="anamespaceteqp_html_a725528c9f3af447069508a622b26c84d"><div class="ttname"><a href="namespaceteqp.html#a725528c9f3af447069508a622b26c84d">teqp::dpsatdT_pure</a></div><div class="ttdeci">auto dpsatdT_pure(const teqp::cppinterface::AbstractModel &amp;model, double T, double rhoL, double rhoV, const std::optional&lt; Eigen::ArrayXd &gt; &amp;molefracs=std::nullopt)</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00158">VLE_pure.hpp:158</a></div></div>
<div class="ttc" id="anamespaceteqp_html_a92911152e3677223eedb7045a0b224b1"><div class="ttname"><a href="namespaceteqp.html#a92911152e3677223eedb7045a0b224b1">teqp::pure_VLE_T</a></div><div class="ttdeci">auto pure_VLE_T(const teqp::cppinterface::AbstractModel &amp;model, double T, double rhoL, double rhoV, int maxiter, const std::optional&lt; Eigen::ArrayXd &gt; &amp;molefracs=std::nullopt)</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00138">VLE_pure.hpp:138</a></div></div>
<div class="ttc" id="anamespaceteqp_html_abf4178adee8264741ab6d892f09a05a9"><div class="ttname"><a href="namespaceteqp.html#abf4178adee8264741ab6d892f09a05a9">teqp::is_AbstractModel</a></div><div class="ttdeci">typename std::is_base_of&lt; teqp::cppinterface::AbstractModel, Model &gt; is_AbstractModel</div><div class="ttdef"><b>Definition</b> <a href="VLE__pure_8hpp_source.html#l00015">VLE_pure.hpp:15</a></div></div>
<div class="ttc" id="astructteqp_1_1TDXDerivatives_html"><div class="ttname"><a href="structteqp_1_1TDXDerivatives.html">teqp::TDXDerivatives</a></div><div class="ttdef"><b>Definition</b> <a href="derivs_8hpp_source.html#l00126">derivs.hpp:126</a></div></div>
<div class="ttc" id="ateqpcpp_8hpp_html"><div class="ttname"><a href="teqpcpp_8hpp.html">teqpcpp.hpp</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
