\doxysection{phase\+\_\+equil.\+hpp}
\hypertarget{phase__equil_8hpp_source}{}\label{phase__equil_8hpp_source}\index{include/teqp/algorithms/phase\_equil.hpp@{include/teqp/algorithms/phase\_equil.hpp}}
\mbox{\hyperlink{phase__equil_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00001}00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <optional>}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{exceptions_8hpp}{teqp/exceptions.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{teqpcpp_8hpp}{teqp/cpp/teqpcpp.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00007}00007\ \textcolor{preprocessor}{\#include\ <Eigen/Dense>}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00009}00009\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespaceteqp_1_1cppinterface}{teqp::cppinterface}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00011}\mbox{\hyperlink{namespaceteqp_1_1algorithms}{00011}}\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceteqp_1_1algorithms_1_1phase__equil}{teqp::algorithms::phase\_equil}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00013}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{00013}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00014}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a8a6a00a1c21bfe3bc299bd89ec348430}{00014}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a8a6a00a1c21bfe3bc299bd89ec348430}{rho}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00015}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9bd91f85e2107e3e4a9f784d565e152a}{00015}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9bd91f85e2107e3e4a9f784d565e152a}{R}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00016}00016\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00017}00017\ \ \ \ \ \textcolor{comment}{//\ Calculated\ parameters}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00018}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9a4847ed3c3c65ff37c2e7b3d44d752f}{00018}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9a4847ed3c3c65ff37c2e7b3d44d752f}{Psir}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00019}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a0c711de55a567947fa970ec1a584a3a7}{00019}}\ \ \ \ \ Eigen::ArrayXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a0c711de55a567947fa970ec1a584a3a7}{gradient\_Psir}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00020}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_afc5c51013880b9dca9c0638609569d99}{00020}}\ \ \ \ \ Eigen::ArrayXXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_afc5c51013880b9dca9c0638609569d99}{Hessian\_Psir}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00021}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a38b68d00b49a2770e10301cc03c80d68}{00021}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a38b68d00b49a2770e10301cc03c80d68}{d\_Psir\_dT}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00022}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_adb932759508c827da9f8337a7ad1bdc5}{00022}}\ \ \ \ \ Eigen::ArrayXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_adb932759508c827da9f8337a7ad1bdc5}{d\_gradient\_Psir\_dT}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00023}00023\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00024}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a311b2450f12789dba9645965d9991561}{00024}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a311b2450f12789dba9645965d9991561}{p}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00025}00025\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a8a6a00a1c21bfe3bc299bd89ec348430}{rho}}*\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9bd91f85e2107e3e4a9f784d565e152a}{R}}*T\ -\/\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9a4847ed3c3c65ff37c2e7b3d44d752f}{Psir}}\ +\ (rhovec*\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a0c711de55a567947fa970ec1a584a3a7}{gradient\_Psir}}).sum();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00026}00026\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00027}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a52db6f9700f42dbd59e5f510587f8239}{00027}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a52db6f9700f42dbd59e5f510587f8239}{dpdT}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00028}00028\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a8a6a00a1c21bfe3bc299bd89ec348430}{rho}}*\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9bd91f85e2107e3e4a9f784d565e152a}{R}}\ -\/\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a38b68d00b49a2770e10301cc03c80d68}{d\_Psir\_dT}}\ +\ (rhovec*\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_adb932759508c827da9f8337a7ad1bdc5}{d\_gradient\_Psir\_dT}}).sum();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00029}00029\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00030}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_af354db0b78520bc32190b432943d4f21}{00030}}\ \ \ \ \ Eigen::ArrayXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_af354db0b78520bc32190b432943d4f21}{dpdrhovec}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00031}00031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9bd91f85e2107e3e4a9f784d565e152a}{R}}*T\ +\ (rhovec.matrix().transpose()*\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_afc5c51013880b9dca9c0638609569d99}{Hessian\_Psir}}.matrix()).array()).eval();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00032}00032\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00033}00033\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00035}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives}{00035}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives}{CaloricPhaseDerivatives}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00036}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{00036}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00037}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_abfebdd8cd93f873e0e9e360c56de0aa9}{00037}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_abfebdd8cd93f873e0e9e360c56de0aa9}{R}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00038}00038\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00039}00039\ \ \ \ \ \textcolor{comment}{//\ Calculated\ parameters}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00040}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a96c231ca512122836b61f1b70e6514e8}{00040}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a96c231ca512122836b61f1b70e6514e8}{Psiig}};\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ -\/-\/]}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00041}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a55bb57e85bc8430ee42371eadb063c4d}{00041}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a55bb57e85bc8430ee42371eadb063c4d}{d\_Psiig\_dT}};\ \ \ \ \ \textcolor{comment}{//\ \ \ ]\ All\ obtained\ in\ one\ call,\ needed\ for\ all\ h,s,u}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00042}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a78b631c82363ced61d6735ca252ed706}{00042}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a78b631c82363ced61d6735ca252ed706}{d2\_Psiig\_dT2}};\ \ \ \textcolor{comment}{//\ -\/-\/]}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00043}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a0036a8c962884007456e1b8d326cad14}{00043}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a0036a8c962884007456e1b8d326cad14}{d2\_Psir\_dT2}};\ \ \ \ \textcolor{comment}{//\ Needed\ for\ entropy,\ not\ needed\ for\ any\ standard\ specifications}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00044}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_ac46fdac640049aaf38ea29d4c8044e3a}{00044}}\ \ \ \ \ Eigen::ArrayXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_ac46fdac640049aaf38ea29d4c8044e3a}{gradient\_Psiig}};\ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ only\ not\ used\ by\ s,\ needed\ for\ h\ and\ u}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00045}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a53f0b5bf3911fa7a74e6ab6f16ccdf80}{00045}}\ \ \ \ \ Eigen::ArrayXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a53f0b5bf3911fa7a74e6ab6f16ccdf80}{d\_gradient\_Psiig\_dT}};\ \ \ \textcolor{comment}{//\ Needed\ for\ h,\ s,\ u}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00046}00046\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00047}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a1221af2e140e6108aa92a89f70a9616d}{00047}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a1221af2e140e6108aa92a89f70a9616d}{s}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}*(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a55bb57e85bc8430ee42371eadb063c4d}{d\_Psiig\_dT}}\ +\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a38b68d00b49a2770e10301cc03c80d68}{d\_Psir\_dT}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00049}00049\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00050}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a95b99e106ee42da22358b7428e0ded5a}{00050}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a95b99e106ee42da22358b7428e0ded5a}{dsdT}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}*(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a78b631c82363ced61d6735ca252ed706}{d2\_Psiig\_dT2}}\ +\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a0036a8c962884007456e1b8d326cad14}{d2\_Psir\_dT2}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00052}00052\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00053}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_abd4a13e2fde1a8e10a153095a23f7e33}{00053}}\ \ \ \ \ Eigen::ArrayXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_abd4a13e2fde1a8e10a153095a23f7e33}{dsdrhovec}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}*(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a53f0b5bf3911fa7a74e6ab6f16ccdf80}{d\_gradient\_Psiig\_dT}}\ +\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_adb932759508c827da9f8337a7ad1bdc5}{d\_gradient\_Psir\_dT}})\ +\ 1/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}*(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a55bb57e85bc8430ee42371eadb063c4d}{d\_Psiig\_dT}}\ +\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a38b68d00b49a2770e10301cc03c80d68}{d\_Psir\_dT}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00055}00055\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00056}00056\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00057}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a8ac8416e2e21a78b9b17636f40d87326}{00057}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a8ac8416e2e21a78b9b17636f40d87326}{a}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00058}00058\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a96c231ca512122836b61f1b70e6514e8}{Psiig}}\ +\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9a4847ed3c3c65ff37c2e7b3d44d752f}{Psir}})/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00059}00059\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00060}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_aee7a94eabaf414d202cf85a74c3ddc30}{00060}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_aee7a94eabaf414d202cf85a74c3ddc30}{dadT}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00061}00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}*(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a55bb57e85bc8430ee42371eadb063c4d}{d\_Psiig\_dT}}\ +\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a38b68d00b49a2770e10301cc03c80d68}{d\_Psir\_dT}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00062}00062\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00063}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_afb8edd72674a4c10b70f3d6253a69a4f}{00063}}\ \ \ \ \ Eigen::ArrayXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_afb8edd72674a4c10b70f3d6253a69a4f}{dadrhovec}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00064}00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}*(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_ac46fdac640049aaf38ea29d4c8044e3a}{gradient\_Psiig}}\ +\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a0c711de55a567947fa970ec1a584a3a7}{gradient\_Psir}})\ -\/\ 1/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}*(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a96c231ca512122836b61f1b70e6514e8}{Psiig}}\ +\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9a4847ed3c3c65ff37c2e7b3d44d752f}{Psir}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00065}00065\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00066}00066\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00067}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a8ef72d1bc8cd73fc7342aed284901547}{00067}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a8ef72d1bc8cd73fc7342aed284901547}{u}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00068}00068\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a8ac8416e2e21a78b9b17636f40d87326}{a}}(T,\ rhovec,\ resid)\ +\ T*\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a1221af2e140e6108aa92a89f70a9616d}{s}}(T,\ rhovec,\ resid);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00069}00069\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00070}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_ab83ded7ec5cda1959e77bc0f45596a3d}{00070}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_ab83ded7ec5cda1959e77bc0f45596a3d}{dudT}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00071}00071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_aee7a94eabaf414d202cf85a74c3ddc30}{dadT}}(T,\ rhovec,\ resid)\ +\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a1221af2e140e6108aa92a89f70a9616d}{s}}(T,\ rhovec,\ resid)\ +\ T*\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a95b99e106ee42da22358b7428e0ded5a}{dsdT}}(T,\ rhovec,\ resid);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00072}00072\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00073}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a0e6ffee643fd4e9b3c6d54d7e24647fa}{00073}}\ \ \ \ \ Eigen::ArrayXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a0e6ffee643fd4e9b3c6d54d7e24647fa}{dudrhovec}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00074}00074\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_afb8edd72674a4c10b70f3d6253a69a4f}{dadrhovec}}(T,\ rhovec,\ resid)\ +\ T*\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_abd4a13e2fde1a8e10a153095a23f7e33}{dsdrhovec}}(T,\ rhovec,\ resid);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00075}00075\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00076}00076\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00077}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_add16225e460e212d1ccc2d8a5183fba1}{00077}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_add16225e460e212d1ccc2d8a5183fba1}{h}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00078}00078\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a8ef72d1bc8cd73fc7342aed284901547}{u}}(T,\ rhovec,\ resid)\ +\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a311b2450f12789dba9645965d9991561}{p}}(T,\ rhovec)/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00079}00079\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00080}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a3e311fa5730dc246614a30f14fcfb2ce}{00080}}\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a3e311fa5730dc246614a30f14fcfb2ce}{dhdT}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00081}00081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_ab83ded7ec5cda1959e77bc0f45596a3d}{dudT}}(T,\ rhovec,\ resid)\ +\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a52db6f9700f42dbd59e5f510587f8239}{dpdT}}(T,\ rhovec)/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00082}00082\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00083}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_ad3ec0eddef4a830ec078f9bc0d72b1f2}{00083}}\ \ \ \ \ Eigen::ArrayXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_ad3ec0eddef4a830ec078f9bc0d72b1f2}{dhdrhovec}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ resid)\textcolor{keyword}{\ const}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a0e6ffee643fd4e9b3c6d54d7e24647fa}{dudrhovec}}(T,\ rhovec,\ resid)\ +\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_af354db0b78520bc32190b432943d4f21}{dpdrhovec}}(T,\ rhovec)/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}\ -\/\ resid.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a311b2450f12789dba9645965d9991561}{p}}(T,\ rhovec)/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}/\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00085}00085\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00086}00086\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00088}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{00088}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{SpecificationSidecar}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00089}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{00089}}\ \ \ \ \ std::size\_t\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}},\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}},\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a99bd9a32ac6b593b4dca5fc478d32221}{Nindependent}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00090}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a8c7d65885a9b207a55d3bc95f1830a30}{00090}}\ \ \ \ \ \textcolor{keywordtype}{double}*\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a8c7d65885a9b207a55d3bc95f1830a30}{ptr\_p\_phase0}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00091}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a89c3c4abdf3650c83a1053cadbef960a}{00091}}\ \ \ \ \ \textcolor{keywordtype}{double}*\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a89c3c4abdf3650c83a1053cadbef960a}{ptr\_dpdT\_phase0}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00092}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_ad6002d2f188edc6ab660c8c624809c9a}{00092}}\ \ \ \ \ Eigen::ArrayXd*\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_ad6002d2f188edc6ab660c8c624809c9a}{ptr\_dpdrho\_phase0}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00093}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_ae364106dc883c22b05f2a2d01d63ab89}{00093}}\ \ \ \ \ std::vector<RequiredPhaseDerivatives>*\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_ae364106dc883c22b05f2a2d01d63ab89}{derivatives}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00094}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4b6ffcce63a5943cfedf4d4da0c0c92f}{00094}}\ \ \ \ \ std::vector<CaloricPhaseDerivatives>*\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4b6ffcce63a5943cfedf4d4da0c0c92f}{caloricderivatives}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00095}00095\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00097}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification}{00097}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification}{AbstractSpecification}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00098}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification_a0ca4329f474e39ab634b0a8f81205e88}{00098}}\ \ \ \ \ \textcolor{keyword}{virtual}\ std::tuple<double,\ Eigen::ArrayXd>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification_a0ca4329f474e39ab634b0a8f81205e88}{r\_Jacobian}}(\textcolor{keyword}{const}\ Eigen::ArrayXd\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{SpecificationSidecar}}\&\ sidecar)\ \textcolor{keyword}{const}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00099}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification_ad17724abe6381c5d7bdfc0998d7c0962}{00099}}\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification_ad17724abe6381c5d7bdfc0998d7c0962}{\string~AbstractSpecification}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00100}00100\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00101}00101\ \textcolor{comment}{/***}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00102}00102\ \textcolor{comment}{\ \(\backslash\)brief\ Specification\ equation\ for\ temperature}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00103}00103\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00104}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1TSpecification}{00104}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1TSpecification}{TSpecification}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification}{AbstractSpecification}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00105}00105\ \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00106}00106\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ m\_Tspec;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00107}00107\ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00108}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1TSpecification_a1daa3901c403d15c4aa7b194f6a28c99}{00108}}\ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1TSpecification_a1daa3901c403d15c4aa7b194f6a28c99}{TSpecification}}(\textcolor{keywordtype}{double}\ T)\ :\ m\_Tspec(T)\ \{\};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00109}00109\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00110}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1TSpecification_a54efce25d85097a6e47760092240d940}{00110}}\ \ \ \ \ \textcolor{keyword}{virtual}\ std::tuple<double,\ Eigen::ArrayXd>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1TSpecification_a54efce25d85097a6e47760092240d940}{r\_Jacobian}}(\textcolor{keyword}{const}\ Eigen::ArrayXd\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{SpecificationSidecar}}\&\ sidecar)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00111}00111\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ r\ =\ x[0]\ -\/\ m\_Tspec;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00112}00112\ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ J(x.size());\ J.setZero();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00113}00113\ \ \ \ \ \ \ \ \ J(0)\ =\ 1;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00114}00114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(r,\ J);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00115}00115\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00116}00116\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00121}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1BetaSpecification}{00121}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1BetaSpecification}{BetaSpecification}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification}{AbstractSpecification}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00122}00122\ \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00123}00123\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ m\_betaspec;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00124}00124\ \ \ \ \ \textcolor{keyword}{const}\ std::size\_t\ m\_iphase;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00125}00125\ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00126}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1BetaSpecification_a88b05f486718626921d658f04051fc1d}{00126}}\ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1BetaSpecification_a88b05f486718626921d658f04051fc1d}{BetaSpecification}}(\textcolor{keywordtype}{double}\ beta,\ std::size\_t\ iphase)\ :\ m\_betaspec(beta),\ m\_iphase(iphase)\ \{\};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00127}00127\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00128}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1BetaSpecification_a06ce1132bcccba86eca3b1f6bdab473f}{00128}}\ \ \ \ \ \textcolor{keyword}{virtual}\ std::tuple<double,\ Eigen::ArrayXd>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1BetaSpecification_a06ce1132bcccba86eca3b1f6bdab473f}{r\_Jacobian}}(\textcolor{keyword}{const}\ Eigen::ArrayXd\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{SpecificationSidecar}}\&\ sidecar)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00129}00129\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ r\ =\ x[x.size()-\/sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}+m\_iphase]\ -\/\ m\_betaspec;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00130}00130\ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ Jrow(x.size());\ Jrow.setZero();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00131}00131\ \ \ \ \ \ \ \ \ Jrow(x.size()-\/sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}+m\_iphase)\ =\ 1;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00132}00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(r,\ Jrow);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00133}00133\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00134}00134\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00141}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1PSpecification}{00141}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1PSpecification}{PSpecification}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification}{AbstractSpecification}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00142}00142\ \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00143}00143\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ m\_p;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00144}00144\ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00145}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1PSpecification_ab47a13660bcff45f5166aae72500eb9c}{00145}}\ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1PSpecification_ab47a13660bcff45f5166aae72500eb9c}{PSpecification}}(\textcolor{keywordtype}{double}\ p\_Pa)\ :\ m\_p(p\_Pa)\ \{\};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00146}00146\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00147}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1PSpecification_a670ee19911309747178f96c9ddef5187}{00147}}\ \ \ \ \ \textcolor{keyword}{virtual}\ std::tuple<double,\ Eigen::ArrayXd>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1PSpecification_a670ee19911309747178f96c9ddef5187}{r\_Jacobian}}(\textcolor{keyword}{const}\ Eigen::ArrayXd\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{SpecificationSidecar}}\&\ sidecar)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00148}00148\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ r\ =\ *sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a8c7d65885a9b207a55d3bc95f1830a30}{ptr\_p\_phase0}}\ -\/\ m\_p;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00149}00149\ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ Jrow(x.size());\ Jrow.setZero();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00150}00150\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00151}00151\ \ \ \ \ \ \ \ \ Jrow(0)\ =\ *sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a89c3c4abdf3650c83a1053cadbef960a}{ptr\_dpdT\_phase0}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00152}00152\ \ \ \ \ \ \ \ \ Jrow.segment(1,\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}})\ =\ *sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_ad6002d2f188edc6ab660c8c624809c9a}{ptr\_dpdrho\_phase0}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00153}00153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(r,\ Jrow);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00154}00154\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00155}00155\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00156}00156\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00160}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarVolumeSpecification}{00160}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarVolumeSpecification}{MolarVolumeSpecification}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification}{AbstractSpecification}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00161}00161\ \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00162}00162\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ m\_vspec\_m3mol;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00163}00163\ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00164}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarVolumeSpecification_a424c72a890f30aff5a0e1111cf38d71a}{00164}}\ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarVolumeSpecification_a424c72a890f30aff5a0e1111cf38d71a}{MolarVolumeSpecification}}(\textcolor{keywordtype}{double}\ v\_m3mol)\ :\ m\_vspec\_m3mol(v\_m3mol)\ \{\};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00165}00165\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00166}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarVolumeSpecification_a485d1350415176e2e9730fcb165cdfe7}{00166}}\ \ \ \ \ \textcolor{keyword}{virtual}\ std::tuple<double,\ Eigen::ArrayXd>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarVolumeSpecification_a485d1350415176e2e9730fcb165cdfe7}{r\_Jacobian}}(\textcolor{keyword}{const}\ Eigen::ArrayXd\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{SpecificationSidecar}}\&\ sidecar)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00167}00167\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ T\ =\ x[0];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00168}00168\ \ \ \ \ \ \ \ \ std::vector<Eigen::Map<const\ Eigen::ArrayXd>>\ rhovecs;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00169}00169\ \ \ \ \ \ \ \ \ std::vector<double>\ rho\_phase;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00170}00170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\_\ =\ 0;\ iphase\_\ <\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}};\ ++iphase\_)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ rhovecs.push\_back(Eigen::Map<const\ Eigen::ArrayXd>(\&x[1\ +\ iphase\_*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}}],\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}}));}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00172}00172\ \ \ \ \ \ \ \ \ \ \ \ \ rho\_phase.push\_back(rhovecs.back().sum());}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00173}00173\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00174}00174\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Map<const\ Eigen::ArrayXd>\ betas(\&x[x.size()-\/sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}],\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00175}00175\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00176}00176\ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ Jrow(x.size());\ Jrow.setZero();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00177}00177\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ v\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00178}00178\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\ =\ 0;\ iphase\ <\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}};\ ++iphase)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00179}00179\ \ \ \ \ \ \ \ \ \ \ \ \ v\ +=\ betas[iphase]/rho\_phase[iphase];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00180}00180\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow(x.size()-\/sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}+iphase)\ =\ 1/rho\_phase[iphase];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00181}00181\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow.segment(1+iphase*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}},\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}})\ =\ -\/betas[iphase]/rho\_phase[iphase]/rho\_phase[iphase];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00182}00182\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00183}00183\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ r\ =\ v\ -\/\ m\_vspec\_m3mol;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00184}00184\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(r,\ Jrow);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00185}00185\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00186}00186\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00187}00187\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00191}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEntropySpecification}{00191}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEntropySpecification}{MolarEntropySpecification}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification}{AbstractSpecification}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00192}00192\ \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00193}00193\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ m\_s\_JmolK;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00194}00194\ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00195}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEntropySpecification_ae7197440c729735f5febfaaa50821cea}{00195}}\ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEntropySpecification_ae7197440c729735f5febfaaa50821cea}{MolarEntropySpecification}}(\textcolor{keywordtype}{double}\ s\_JmolK)\ :\ m\_s\_JmolK(s\_JmolK)\ \{\};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00196}00196\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00197}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEntropySpecification_a7a1f9b20ce117d0c4de5cebc894bb66d}{00197}}\ \ \ \ \ \textcolor{keyword}{virtual}\ std::tuple<double,\ Eigen::ArrayXd>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEntropySpecification_a7a1f9b20ce117d0c4de5cebc894bb66d}{r\_Jacobian}}(\textcolor{keyword}{const}\ Eigen::ArrayXd\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{SpecificationSidecar}}\&\ sidecar)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00198}00198\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ T\ =\ x[0];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00199}00199\ \ \ \ \ \ \ \ \ std::vector<Eigen::Map<const\ Eigen::ArrayXd>>\ rhovecs;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00200}00200\ \ \ \ \ \ \ \ \ std::vector<double>\ rho\_phase;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00201}00201\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\_\ =\ 0;\ iphase\_\ <\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}};\ ++iphase\_)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \ \ \ rhovecs.push\_back(Eigen::Map<const\ Eigen::ArrayXd>(\&x[1\ +\ iphase\_*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}}],\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}}));}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00203}00203\ \ \ \ \ \ \ \ \ \ \ \ \ rho\_phase.push\_back(rhovecs.back().sum());}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00204}00204\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00205}00205\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Map<const\ Eigen::ArrayXd>\ betas(\&x[x.size()-\/sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}],\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00206}00206\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4b6ffcce63a5943cfedf4d4da0c0c92f}{caloricderivatives}}\ ==\ \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00207}00207\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classteqp_1_1InvalidArgument}{teqp::InvalidArgument}}(\textcolor{stringliteral}{"{}Must\ have\ connected\ the\ ideal\ gas\ pointer"{}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00208}00208\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00209}00209\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00210}00210\ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ Jrow(x.size());\ Jrow.setZero();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00211}00211\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ s\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00212}00212\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\ =\ 0;\ iphase\ <\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}};\ ++iphase)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ cal\ =\ (*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4b6ffcce63a5943cfedf4d4da0c0c92f}{caloricderivatives}})[iphase];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00214}00214\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ der\ =\ (*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_ae364106dc883c22b05f2a2d01d63ab89}{derivatives}})[iphase];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00215}00215\ \ \ \ \ \ \ \ \ \ \ \ \ s\ +=\ betas[iphase]*cal.s(T,\ rhovecs[iphase],\ der);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00216}00216\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow(0)\ +=\ betas[iphase]*cal.dsdT(T,\ rhovecs[iphase],\ der);\ \textcolor{comment}{//\ Temperature\ derivative,\ all\ phases}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00217}00217\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow(x.size()-\/sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}+iphase)\ =\ cal.s(T,\ rhovecs[iphase],\ der);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00218}00218\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow.segment(1+iphase*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}},\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}})\ =\ betas[iphase]*cal.dsdrhovec(T,\ rhovecs[iphase],\ der);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00219}00219\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00220}00220\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ r\ =\ s\ -\/\ m\_s\_JmolK;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00221}00221\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(r,\ Jrow);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00222}00222\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00223}00223\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00224}00224\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00228}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarInternalEnergySpecification}{00228}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarInternalEnergySpecification}{MolarInternalEnergySpecification}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification}{AbstractSpecification}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00229}00229\ \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00230}00230\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ m\_u\_Jmol;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00231}00231\ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00232}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarInternalEnergySpecification_af4f6329ff55671d1591a5155f15b5135}{00232}}\ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarInternalEnergySpecification_af4f6329ff55671d1591a5155f15b5135}{MolarInternalEnergySpecification}}(\textcolor{keywordtype}{double}\ u\_Jmol)\ :\ m\_u\_Jmol(u\_Jmol)\ \{\};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00233}00233\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00234}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarInternalEnergySpecification_a56553d44e2414d76ee2f35ffec65aff3}{00234}}\ \ \ \ \ \textcolor{keyword}{virtual}\ std::tuple<double,\ Eigen::ArrayXd>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarInternalEnergySpecification_a56553d44e2414d76ee2f35ffec65aff3}{r\_Jacobian}}(\textcolor{keyword}{const}\ Eigen::ArrayXd\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{SpecificationSidecar}}\&\ sidecar)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00235}00235\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ T\ =\ x[0];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00236}00236\ \ \ \ \ \ \ \ \ std::vector<Eigen::Map<const\ Eigen::ArrayXd>>\ rhovecs;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00237}00237\ \ \ \ \ \ \ \ \ std::vector<double>\ rho\_phase;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00238}00238\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\_\ =\ 0;\ iphase\_\ <\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}};\ ++iphase\_)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00239}00239\ \ \ \ \ \ \ \ \ \ \ \ \ rhovecs.push\_back(Eigen::Map<const\ Eigen::ArrayXd>(\&x[1\ +\ iphase\_*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}}],\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}}));}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00240}00240\ \ \ \ \ \ \ \ \ \ \ \ \ rho\_phase.push\_back(rhovecs.back().sum());}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00241}00241\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00242}00242\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Map<const\ Eigen::ArrayXd>\ betas(\&x[x.size()-\/sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}],\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00243}00243\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4b6ffcce63a5943cfedf4d4da0c0c92f}{caloricderivatives}}\ ==\ \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00244}00244\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classteqp_1_1InvalidArgument}{teqp::InvalidArgument}}(\textcolor{stringliteral}{"{}Must\ have\ connected\ the\ ideal\ gas\ pointer"{}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00245}00245\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00246}00246\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00247}00247\ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ Jrow(x.size());\ Jrow.setZero();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00248}00248\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ u\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00249}00249\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\ =\ 0;\ iphase\ <\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}};\ ++iphase)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00250}00250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ cal\ =\ (*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4b6ffcce63a5943cfedf4d4da0c0c92f}{caloricderivatives}})[iphase];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00251}00251\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ der\ =\ (*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_ae364106dc883c22b05f2a2d01d63ab89}{derivatives}})[iphase];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00252}00252\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ u\_phase\ =\ cal.u(T,\ rhovecs[iphase],\ der);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00253}00253\ \ \ \ \ \ \ \ \ \ \ \ \ u\ +=\ betas[iphase]*u\_phase;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00254}00254\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow(0)\ +=\ betas[iphase]*cal.dudT(T,\ rhovecs[iphase],\ der);\ \textcolor{comment}{//\ Temperature\ derivative,\ all\ phases}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00255}00255\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow(x.size()-\/sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}+iphase)\ =\ u\_phase;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00256}00256\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow.segment(1+iphase*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}},\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}})\ =\ betas[iphase]*cal.dudrhovec(T,\ rhovecs[iphase],\ der);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00257}00257\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00258}00258\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ r\ =\ u\ -\/\ m\_u\_Jmol;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00259}00259\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(r,\ Jrow);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00260}00260\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00261}00261\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00262}00262\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00266}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEnthalpySpecification}{00266}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEnthalpySpecification}{MolarEnthalpySpecification}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1AbstractSpecification}{AbstractSpecification}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00267}00267\ \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00268}00268\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ m\_h\_Jmol;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00269}00269\ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00270}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEnthalpySpecification_a925c8efb5e2316cb98e9eb1dd72ab277}{00270}}\ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEnthalpySpecification_a925c8efb5e2316cb98e9eb1dd72ab277}{MolarEnthalpySpecification}}(\textcolor{keywordtype}{double}\ h\_Jmol)\ :\ m\_h\_Jmol(h\_Jmol)\ \{\};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00271}00271\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00272}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEnthalpySpecification_ad5ad9c44ab52f3f5be5a3d2e8e54b7af}{00272}}\ \ \ \ \ \textcolor{keyword}{virtual}\ std::tuple<double,\ Eigen::ArrayXd>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1MolarEnthalpySpecification_ad5ad9c44ab52f3f5be5a3d2e8e54b7af}{r\_Jacobian}}(\textcolor{keyword}{const}\ Eigen::ArrayXd\&\ x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{SpecificationSidecar}}\&\ sidecar)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00273}00273\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ T\ =\ x[0];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00274}00274\ \ \ \ \ \ \ \ \ std::vector<Eigen::Map<const\ Eigen::ArrayXd>>\ rhovecs;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00275}00275\ \ \ \ \ \ \ \ \ std::vector<double>\ rho\_phase;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00276}00276\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\_\ =\ 0;\ iphase\_\ <\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}};\ ++iphase\_)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00277}00277\ \ \ \ \ \ \ \ \ \ \ \ \ rhovecs.push\_back(Eigen::Map<const\ Eigen::ArrayXd>(\&x[1\ +\ iphase\_*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}}],\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}}));}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ rho\_phase.push\_back(rhovecs.back().sum());}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00279}00279\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00280}00280\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Map<const\ Eigen::ArrayXd>\ betas(\&x[x.size()-\/sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}],\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00281}00281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4b6ffcce63a5943cfedf4d4da0c0c92f}{caloricderivatives}}\ ==\ \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00282}00282\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classteqp_1_1InvalidArgument}{teqp::InvalidArgument}}(\textcolor{stringliteral}{"{}Must\ have\ connected\ the\ ideal\ gas\ pointer"{}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00283}00283\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00284}00284\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00285}00285\ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ Jrow(x.size());\ Jrow.setZero();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00286}00286\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ h\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00287}00287\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\ =\ 0;\ iphase\ <\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}};\ ++iphase)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00288}00288\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ cal\ =\ (*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4b6ffcce63a5943cfedf4d4da0c0c92f}{caloricderivatives}})[iphase];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00289}00289\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\&\ der\ =\ (*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_ae364106dc883c22b05f2a2d01d63ab89}{derivatives}})[iphase];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00290}00290\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ h\_phase\ =\ cal.h(T,\ rhovecs[iphase],\ der);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00291}00291\ \ \ \ \ \ \ \ \ \ \ \ \ h\ +=\ betas[iphase]*h\_phase;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00292}00292\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow(0)\ +=\ betas[iphase]*cal.dhdT(T,\ rhovecs[iphase],\ der);\ \textcolor{comment}{//\ Temperature\ derivative,\ all\ phases}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00293}00293\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow(x.size()-\/sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}+iphase)\ =\ h\_phase;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00294}00294\ \ \ \ \ \ \ \ \ \ \ \ \ Jrow.segment(1+iphase*sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}},\ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}})\ =\ betas[iphase]*cal.dhdrhovec(T,\ rhovecs[iphase],\ der);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00295}00295\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00296}00296\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ r\ =\ h\ -\/\ m\_h\_Jmol;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00297}00297\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(r,\ Jrow);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00298}00298\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00299}00299\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00300}00300\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00304}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium}{00304}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium}{GeneralizedPhaseEquilibrium}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00305}00305\ \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00306}00306\ \ \ \ \ \textcolor{keyword}{auto}\ get\_Ncomponents(\textcolor{keyword}{const}\ std::vector<Eigen::ArrayXd>\&\ rhovecs)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00307}00307\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ all\ are\ the\ same\ size,\ and\ nonempty}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00308}00308\ \ \ \ \ \ \ \ \ std::set<std::size\_t>\ sizes;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00309}00309\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ rhovec\ :\ rhovecs)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \ \ \ sizes.emplace(rhovec.size());}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00311}00311\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00312}00312\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sizes.size()\ !=\ 1)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00313}00313\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00314}00314\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00315}00315\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ size\ :\ sizes)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ ==\ 0)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00317}00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00318}00318\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00319}00319\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ size;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00320}00320\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00321}00321\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00322}00322\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00323}00323\ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00324}00324\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00325}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult}{00325}}\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult}{CallResult}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00326}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4a4655d7af333cd67c6e27ab21aa8689}{00326}}\ \ \ \ \ \ \ \ \ Eigen::VectorXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4a4655d7af333cd67c6e27ab21aa8689}{r}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00327}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4071b3ecb602bfeb7f218e4708569663}{00327}}\ \ \ \ \ \ \ \ \ Eigen::MatrixXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4071b3ecb602bfeb7f218e4708569663}{J}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00328}00328\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00329}00329\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00330}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables}{00330}}\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables}{UnpackedVariables}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00331}00331\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00332}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_aca987269cc7dd0025ddf1f9e65c544b7}{00332}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_aca987269cc7dd0025ddf1f9e65c544b7}{T}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00333}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a0d2f724e94361797905d440c7dfd1f2d}{00333}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<Eigen::ArrayXd>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a0d2f724e94361797905d440c7dfd1f2d}{rhovecs}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00334}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a56b55b200e9fbc3a4118ccd62aa4c97d}{00334}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::ArrayXd\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a56b55b200e9fbc3a4118ccd62aa4c97d}{betas}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00335}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a417b29fd1c47ac1c94e0c4e78c69be7b}{00335}}\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a417b29fd1c47ac1c94e0c4e78c69be7b}{UnpackedVariables}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_aca987269cc7dd0025ddf1f9e65c544b7}{T}},\ \textcolor{keyword}{const}\ std::vector<Eigen::ArrayXd>\&\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a0d2f724e94361797905d440c7dfd1f2d}{rhovecs}},\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a56b55b200e9fbc3a4118ccd62aa4c97d}{betas}})\ :\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_aca987269cc7dd0025ddf1f9e65c544b7}{T}}(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_aca987269cc7dd0025ddf1f9e65c544b7}{T}}),\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a0d2f724e94361797905d440c7dfd1f2d}{rhovecs}}(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a0d2f724e94361797905d440c7dfd1f2d}{rhovecs}}),\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a56b55b200e9fbc3a4118ccd62aa4c97d}{betas}}(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a56b55b200e9fbc3a4118ccd62aa4c97d}{betas}})\{\};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00336}00336\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00337}\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a1adda508c5a286d51681b08d757ce3b5}{00337}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a1adda508c5a286d51681b08d757ce3b5}{pack}}()\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}}\ =\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a56b55b200e9fbc3a4118ccd62aa4c97d}{betas}}.size();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{Ncomponents}}\ =\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a0d2f724e94361797905d440c7dfd1f2d}{rhovecs}}[0].size();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00340}00340\ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ x(1+(\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{Ncomponents}}+1)*\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00341}00341\ \ \ \ \ \ \ \ \ \ \ \ \ x[0]\ =\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_aca987269cc7dd0025ddf1f9e65c544b7}{T}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00342}00342\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\_\ =\ 0;\ iphase\_\ <\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}};\ ++iphase\_)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00343}00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::Map<Eigen::ArrayXd>(\&x[1\ +\ iphase\_*\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{Ncomponents}}],\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{Ncomponents}})\ =\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a0d2f724e94361797905d440c7dfd1f2d}{rhovecs}}[iphase\_];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00344}00344\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00345}00345\ \ \ \ \ \ \ \ \ \ \ \ \ x.tail(\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a56b55b200e9fbc3a4118ccd62aa4c97d}{betas}}.size())\ =\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a56b55b200e9fbc3a4118ccd62aa4c97d}{betas}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00346}00346\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00347}00347\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00348}00348\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00349}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a7e754dd3559f068eff061a765c272edc}{00349}}\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel}{AbstractModel}}\&\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a7e754dd3559f068eff061a765c272edc}{residptr}};\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00350}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a0ba2d7bcc1aa569e0ceecc352314a781}{00350}}\ \ \ \ \ std::optional<std::shared\_ptr<const\ AbstractModel>>\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a0ba2d7bcc1aa569e0ceecc352314a781}{idealgasptr}};\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00351}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_af5ea9978642262096e1eea2b22a3d940}{00351}}\ \ \ \ \ \textcolor{keyword}{const}\ Eigen::ArrayXd\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_af5ea9978642262096e1eea2b22a3d940}{zbulk}};\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00352}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{00352}}\ \ \ \ \ \textcolor{keyword}{const}\ std::size\_t\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{Ncomponents}},\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00353}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{00353}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}},\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00354}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{00354}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}};\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00355}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a39d8d1ca812e9b9f8c133c302d5adf05}{00355}}\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::shared\_ptr<AbstractSpecification>>\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a39d8d1ca812e9b9f8c133c302d5adf05}{specifications}};\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00356}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a421f8d13f8adb241f64b86432c45838d}{00356}}\ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult}{CallResult}}\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a421f8d13f8adb241f64b86432c45838d}{res}};\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00357}00357\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00370}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a3807dc7368aa6c15ed82ae70680ac44e}{00370}}\ \ \ \ \ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a3807dc7368aa6c15ed82ae70680ac44e}{GeneralizedPhaseEquilibrium}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel}{AbstractModel}}\&\ residmodel,}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00371}00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_af5ea9978642262096e1eea2b22a3d940}{zbulk}},}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00372}00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables}{UnpackedVariables}}\&\ init,}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00373}00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::shared\_ptr<AbstractSpecification>>\&\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a39d8d1ca812e9b9f8c133c302d5adf05}{specifications}}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00374}00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00375}00375\ \ \ \ \ :\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a7e754dd3559f068eff061a765c272edc}{residptr}}(residmodel),\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_af5ea9978642262096e1eea2b22a3d940}{zbulk}}(\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_af5ea9978642262096e1eea2b22a3d940}{zbulk}}),\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{Ncomponents}}(get\_Ncomponents(init.rhovecs)),\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}}(init.betas.size()),\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}}(1+(\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{Ncomponents}}+1)*\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}}),\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a39d8d1ca812e9b9f8c133c302d5adf05}{specifications}}(\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a39d8d1ca812e9b9f8c133c302d5adf05}{specifications}})}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00376}00376\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00377}00377\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (init.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a56b55b200e9fbc3a4118ccd62aa4c97d}{betas}}.size()\ !=\ init.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1UnpackedVariables_a0d2f724e94361797905d440c7dfd1f2d}{rhovecs}}.size())\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00378}00378\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classteqp_1_1InvalidArgument}{teqp::InvalidArgument}}(\textcolor{stringliteral}{"{}bad\ sizes\ for\ initial\ betas\ and\ rhovecs"{}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00379}00379\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00380}00380\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a39d8d1ca812e9b9f8c133c302d5adf05}{specifications}}.size()\ !=\ 2)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00381}00381\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classteqp_1_1InvalidArgument}{teqp::InvalidArgument}}(\textcolor{stringliteral}{"{}specification\ vector\ should\ be\ of\ length\ 2"{}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00382}00382\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00383}00383\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00384}00384\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Resize\ the\ working\ buffers}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00385}00385\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a421f8d13f8adb241f64b86432c45838d}{res}}.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4a4655d7af333cd67c6e27ab21aa8689}{r}}.resize(\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00386}00386\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a421f8d13f8adb241f64b86432c45838d}{res}}.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4071b3ecb602bfeb7f218e4708569663}{J}}.resize(\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}},\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00387}00387\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00388}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_af6576f13272496a2797c98b8017e69cc}{00388}}\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_af6576f13272496a2797c98b8017e69cc}{attach\_ideal\_gas}}(\textcolor{keyword}{const}\ std::shared\_ptr<const\ AbstractModel>\&\ ptr)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00389}00389\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a0ba2d7bcc1aa569e0ceecc352314a781}{idealgasptr}}\ =\ ptr;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00390}00390\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00391}00391\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00396}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_ac291dcade165fe12ea18570f963424c5}{00396}}\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_ac291dcade165fe12ea18570f963424c5}{call}}(\textcolor{keyword}{const}\ Eigen::ArrayXd\&x)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00397}00397\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Two\ references\ to\ save\ some\ typing\ later\ on}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00398}00398\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ J\ =\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a421f8d13f8adb241f64b86432c45838d}{res}}.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4071b3ecb602bfeb7f218e4708569663}{J}};\ J.setZero();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00399}00399\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ r\ =\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a421f8d13f8adb241f64b86432c45838d}{res}}.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4a4655d7af333cd67c6e27ab21aa8689}{r}};\ r.setZero();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00400}00400\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ Ncomp\ =\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{Ncomponents}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00401}00401\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00402}00402\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Unpack\ into\ the\ variables\ of\ interest\ (as\ maps\ where\ possible\ to\ avoid\ copies)}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00403}00403\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x.size()\ !=\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}})\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00404}00404\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \mbox{\hyperlink{classteqp_1_1InvalidArgument}{teqp::InvalidArgument}}(\textcolor{stringliteral}{"{}Wrong\ size;\ should\ be\ of\ size"{}}+\ std::to\_string(\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}})\ +\ \textcolor{stringliteral}{"{};\ is\ of\ size\ "{}}\ +\ std::to\_string(x.size()));}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00405}00405\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00406}00406\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ T\ =\ x[0];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00407}00407\ \ \ \ \ \ \ \ \ std::vector<Eigen::Map<const\ Eigen::ArrayXd>>\ rhovecs;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00408}00408\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\_\ =\ 0;\ iphase\_\ <\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}};\ ++iphase\_)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00409}00409\ \ \ \ \ \ \ \ \ \ \ \ \ rhovecs.push\_back(Eigen::Map<const\ Eigen::ArrayXd>(\&x[1\ +\ iphase\_*Ncomp],\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{Ncomponents}}));}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00410}00410\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00411}00411\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Eigen::Map<const\ Eigen::ArrayXd>\ betas(\&x[x.size()-\/\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}}],\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00412}00412\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ R\ =\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a7e754dd3559f068eff061a765c272edc}{residptr}}.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_a38884acb6a2663fe18967760e9438b68}{get\_R}}(\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_af5ea9978642262096e1eea2b22a3d940}{zbulk}});\ \textcolor{comment}{//\ TODO:\ think\ about\ what\ to\ do\ when\ the\ phases\ have\ different\ R\ values\ and\ dR/drho\_i\ is\ nonzero}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00413}00413\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00414}00414\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ required\ derivatives\ for\ each\ phase}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00415}00415\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ based\ on\ its\ temperature\ and\ molar\ concentrations}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00416}00416\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ calculate\_required\_derivatives\ =\ [\textcolor{keyword}{this},\ R](\textcolor{keyword}{auto}\&\ modelref,\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec)\ -\/>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00417}00417\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives}{RequiredPhaseDerivatives}}\ der;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00418}00418\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a8a6a00a1c21bfe3bc299bd89ec348430}{rho}}\ =\ rhovec.sum();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00419}00419\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9bd91f85e2107e3e4a9f784d565e152a}{R}}\ =\ R;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00420}00420\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Three\ in\ one\ via\ tuple\ unpacking}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00421}00421\ \ \ \ \ \ \ \ \ \ \ \ \ std::tie(der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9a4847ed3c3c65ff37c2e7b3d44d752f}{Psir}},\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a0c711de55a567947fa970ec1a584a3a7}{gradient\_Psir}},\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_afc5c51013880b9dca9c0638609569d99}{Hessian\_Psir}})\ =\ modelref.build\_Psir\_fgradHessian\_autodiff(T,\ rhovec);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00422}00422\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ And\ then\ the\ temperature\ derivatives}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00423}00423\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Psir\ =\ ar*R*T*rho}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00424}00424\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ d(Psir)/dT\ =\ d(rho*alphar*R*T)/dT\ =\ rho*R*d(alphar*T)/dT\ =\ rho*R*(T*dalphar/dT\ +\ alphar)\ =\ rho*R*(T*dalphar/dT)\ +\ Psir/T}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00425}00425\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ and\ T*dalphar/dT\ =\ -\/Ar10\ so}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00426}00426\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a38b68d00b49a2770e10301cc03c80d68}{d\_Psir\_dT}}\ =\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a8a6a00a1c21bfe3bc299bd89ec348430}{rho}}*R*(-\/modelref.get\_Ar10(T,\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a8a6a00a1c21bfe3bc299bd89ec348430}{rho}},\ rhovec/der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a8a6a00a1c21bfe3bc299bd89ec348430}{rho}}))\ +\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_a9a4847ed3c3c65ff37c2e7b3d44d752f}{Psir}}/T;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00427}00427\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1RequiredPhaseDerivatives_adb932759508c827da9f8337a7ad1bdc5}{d\_gradient\_Psir\_dT}}\ =\ modelref.build\_d2PsirdTdrhoi\_autodiff(T,\ rhovec);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00428}00428\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ der;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00429}00429\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00430}00430\ \ \ \ \ \ \ \ \ std::vector<RequiredPhaseDerivatives>\ derivatives;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00431}00431\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\_\ =\ 0;\ iphase\_\ <\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}};\ ++iphase\_)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00432}00432\ \ \ \ \ \ \ \ \ \ \ \ \ derivatives.emplace\_back(calculate\_required\_derivatives(this-\/>residptr,\ T,\ rhovecs[iphase\_]));}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00433}00433\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00434}00434\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00435}00435\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ First\ we\ have\ the\ equalities\ in\ (natural)\ logarithm\ of\ fugacity\ coefficient\ (always\ present)}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00436}00436\ \ \ \ \ \ \ \ \ std::size\_t\ irow\ =\ 0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00437}00437\ \ \ \ \ \ \ \ \ std::size\_t\ iphase\ =\ 0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00438}00438\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00439}00439\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ lnf\_phase0\ =\ log(rhovecs[iphase]*R*T)\ +\ 1/(R*T)*derivatives[iphase].gradient\_Psir;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00440}00440\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ dlnfdT\_phase0\ =\ 1/T\ +\ 1/(R*T)*derivatives[iphase].d\_gradient\_Psir\_dT\ -\/\ 1/(R*T*T)*derivatives[iphase].gradient\_Psir;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00441}00441\ \ \ \ \ \ \ \ \ Eigen::ArrayXXd\ dlnfdrho\_phase0\ =\ Eigen::MatrixXd::Identity(Ncomp,\ Ncomp);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00442}00442\ \ \ \ \ \ \ \ \ dlnfdrho\_phase0.matrix().diagonal().array()\ /=\ rhovecs[iphase];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00443}00443\ \ \ \ \ \ \ \ \ dlnfdrho\_phase0\ +=\ 1/(R*T)*derivatives[iphase].Hessian\_Psir;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00444}00444\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00445}00445\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphasei\ =\ 1;\ iphasei\ <\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}};\ ++iphasei)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00446}00446\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Equality\ of\ all\ ln(f)\ for\ phase\ with\ index\ 0\ and\ that\ of\ index\ iphase}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00447}00447\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ lnf\_phasei\ =\ log(rhovecs[iphasei]*R*T)\ +\ 1.0/(R*T)*derivatives[iphasei].gradient\_Psir;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00448}00448\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ dlnfdT\_phasei\ =\ 1/T\ +\ 1.0/(R*T)*derivatives[iphasei].d\_gradient\_Psir\_dT\ -\/\ 1/(R*T*T)*derivatives[iphasei].gradient\_Psir;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00449}00449\ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::ArrayXXd\ dlnfdrho\_phasei\ =\ Eigen::MatrixXd::Identity(Ncomp,\ Ncomp);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00450}00450\ \ \ \ \ \ \ \ \ \ \ \ \ dlnfdrho\_phasei.matrix().diagonal().array()\ /=\ rhovecs[iphasei];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00451}00451\ \ \ \ \ \ \ \ \ \ \ \ \ dlnfdrho\_phasei\ +=\ 1/(R*T)*derivatives[iphasei].Hessian\_Psir;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00452}00452\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00453}00453\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ There\ are\ Ncomp\ equalities\ for\ this\ phase\ for\ each\ component}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00454}00454\ \ \ \ \ \ \ \ \ \ \ \ \ r.segment(irow,\ Ncomp)\ =\ lnf\_phase0\ -\/\ lnf\_phasei;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00455}00455\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ And\ Ncomp\ entries\ in\ the\ first\ column\ (of\ index\ 0)\ in\ the\ Jacobian\ for\ the}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00456}00456\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ temperature\ derivative}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00457}00457\ \ \ \ \ \ \ \ \ \ \ \ \ J.block(irow,\ 0,\ Ncomp,\ 1)\ =\ dlnfdT\_phase0\ -\/\ dlnfdT\_phasei;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00458}00458\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ And\ in\ the\ rows\ in\ the\ Jacobian,\ there\ is\ a\ block\ for\ each\ phase,}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00459}00459\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ including\ the\ first\ one\ with\ index\ 0,\ and\ the\ correct\ block\ needs\ to\ be\ selected}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00460}00460\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ which\ for\ first\ phase\ is\ of\ positive\ sign,\ and\ elsewhere,\ of\ negative\ sign}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00461}00461\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphasej\ =\ 0;\ iphasej\ <\ Ncomp;\ ++iphasej)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00462}00462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (iphasej\ ==\ 0)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00463}00463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ J.block(irow,\ 1+iphasej*Ncomp,\ Ncomp,\ Ncomp)\ =\ dlnfdrho\_phase0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00464}00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00465}00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00466}00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ J.block(irow,\ 1+iphasej*Ncomp,\ Ncomp,\ Ncomp)\ =\ -\/dlnfdrho\_phasei;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00467}00467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00468}00468\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00469}00469\ \ \ \ \ \ \ \ \ \ \ \ \ irow\ +=\ Ncomp;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00470}00470\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00471}00471\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00472}00472\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Then\ we\ have\ the\ equality\ of\ pressure\ between\ all\ the\ phases\ (always\ present)}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00473}00473\ \ \ \ \ \ \ \ \ iphase\ =\ 0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00474}00474\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ p\_phase0\ =\ derivatives[iphase].p(T,\ rhovecs[iphase]);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00475}00475\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dpdT\_phase0\ =\ derivatives[iphase].dpdT(T,\ rhovecs[iphase]);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00476}00476\ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ dpdrho\_phase0\ =\ derivatives[iphase].dpdrhovec(T,\ rhovecs[iphase]);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00477}00477\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphasei\ =\ 1;\ iphasei\ <\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}};\ ++iphasei)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00478}00478\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ p\_phasei\ =\ derivatives[iphasei].p(T,\ rhovecs[iphasei]);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00479}00479\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dpdT\_phasei\ =\ derivatives[iphasei].dpdT(T,\ rhovecs[iphasei]);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00480}00480\ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ dpdrho\_phasei\ =\ derivatives[iphasei].dpdrhovec(T,\ rhovecs[iphasei]);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00481}00481\ \ \ \ \ \ \ \ \ \ \ \ \ r[irow]\ =\ p\_phase0\ -\/\ p\_phasei;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00482}00482\ \ \ \ \ \ \ \ \ \ \ \ \ J(irow,\ 0)\ =\ dpdT\_phase0\ -\/\ dpdT\_phasei;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00483}00483\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphasej\ =\ 0;\ iphasej\ <\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}};\ ++iphasej)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00484}00484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (iphasej\ ==\ 0)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00485}00485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ J.block(irow,\ 1+iphasej*Ncomp,\ 1,\ Ncomp)\ =\ dpdrho\_phase0.transpose();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00486}00486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00487}00487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00488}00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ J.block(irow,\ 1+iphasej*Ncomp,\ 1,\ Ncomp)\ =\ -\/dpdrho\_phasei.transpose();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00489}00489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00490}00490\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00491}00491\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Note:\ no\ Jacobian\ contribution\ for\ derivatives\ w.r.t.\ betas}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00492}00492\ \ \ \ \ \ \ \ \ \ \ \ \ irow\ +=\ 1;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00493}00493\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00494}00494\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00495}00495\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Then\ we\ have\ the\ Ncomp-\/1\ material\ balances\ (always\ present)}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00496}00496\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ icomp\ =\ 0;\ icomp\ <\ Ncomp-\/1;\ ++icomp)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00497}00497\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ summer\ =\ 0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00498}00498\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (iphase\ =\ 0;\ iphase\ <\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}};\ ++iphase)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00499}00499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ rho\_phase\ =\ rhovecs[iphase].sum();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00500}00500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ xj\_phk\ =\ rhovecs[iphase][icomp]/rho\_phase;\ \textcolor{comment}{//\ mole\ fraction\ of\ component\ j\ in\ phase\ k}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00501}00501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ summer\ +=\ betas[iphase]*xj\_phk;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00502}00502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ J(irow,\ J.cols()-\/\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}}+iphase)\ =\ xj\_phk;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00503}00503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ icompj\ =\ 0;\ icompj\ <\ Ncomp;\ ++icompj)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00504}00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ Kronecker\ =\ [](\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j)\{\ \textcolor{keywordflow}{return}\ i==j;\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00505}00505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ J(irow,\ 1+iphase*Ncomp\ +\ icompj)\ =\ betas[iphase]*(Kronecker(icomp,icompj)\ -\/\ rhovecs[iphase][icomp]/rho\_phase)/rho\_phase;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00506}00506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00507}00507\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00508}00508\ \ \ \ \ \ \ \ \ \ \ \ \ r[irow]\ =\ summer\ -\/\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_af5ea9978642262096e1eea2b22a3d940}{zbulk}}[icomp];}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00509}00509\ \ \ \ \ \ \ \ \ \ \ \ \ irow++;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00510}00510\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00511}00511\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00512}00512\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Summation\ of\ molar\ phase\ fractions\ beta\ (always\ present)}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00513}00513\ \ \ \ \ \ \ \ \ r[irow]\ =\ betas.sum()-\/1;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00514}00514\ \ \ \ \ \ \ \ \ J.block(irow,\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}}-\/\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}},\ 1,\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}}).fill(1.0);\ \textcolor{comment}{//\ All\ other\ derivatives\ zero}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00515}00515\ \ \ \ \ \ \ \ \ irow\ +=\ 1;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00516}00516\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00517}00517\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ And\ two\ specification\ equations}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00518}00518\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar}{SpecificationSidecar}}\ sidecar;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00519}00519\ \ \ \ \ \ \ \ \ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4d583f56fd69e74e9f521161e759514e}{Nphases}}\ =\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00520}00520\ \ \ \ \ \ \ \ \ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a57ab74eedf6abb717ccaced1a649c3f8}{Ncomponents}}\ =\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a5ab9bafa5ac440efeefbff333124f442}{Ncomponents}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00521}00521\ \ \ \ \ \ \ \ \ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a99bd9a32ac6b593b4dca5fc478d32221}{Nindependent}}\ =\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00522}00522\ \ \ \ \ \ \ \ \ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a8c7d65885a9b207a55d3bc95f1830a30}{ptr\_p\_phase0}}\ =\ \&p\_phase0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00523}00523\ \ \ \ \ \ \ \ \ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a89c3c4abdf3650c83a1053cadbef960a}{ptr\_dpdT\_phase0}}\ =\ \&dpdT\_phase0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00524}00524\ \ \ \ \ \ \ \ \ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_ad6002d2f188edc6ab660c8c624809c9a}{ptr\_dpdrho\_phase0}}\ =\ \&dpdrho\_phase0;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00525}00525\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00526}00526\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ any\ of\ the\ specification\ equations\ require\ caloric\ properties,\ calculate\ them}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00527}00527\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ for\ all\ phases}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00528}00528\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ calculate\_caloric\_derivatives\ =\ [\textcolor{keyword}{this},\ R](\textcolor{keyword}{auto}\&\ modelref,\ \textcolor{keyword}{auto}\&\ modelresid,\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ rhovec)\ -\/>\ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives}{CaloricPhaseDerivatives}}\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00529}00529\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives}{CaloricPhaseDerivatives}}\ der;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00530}00530\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}\ =\ rhovec.sum();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00531}00531\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_abfebdd8cd93f873e0e9e360c56de0aa9}{R}}\ =\ R;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00532}00532\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ molefracs\ =\ (rhovec/der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}).eval();}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00533}00533\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a96c231ca512122836b61f1b70e6514e8}{Psiig}}\ =\ modelref.get\_Ar00(T,\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}},\ molefracs)*R*T*der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00534}00534\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ And\ then\ the\ temperature\ derivatives}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00535}00535\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Psir\ =\ ar*R*T*rho}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00536}00536\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ d(Psir)/dT\ =\ d(rho*alphar*R*T)/dT\ =\ rho*R*d(alphar*T)/dT\ =\ rho*R*(T*dalphar/dT\ +\ alphar)}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00537}00537\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ and\ T*dalphar/dT\ =\ -\/Ar10\ so}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00538}00538\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a55bb57e85bc8430ee42371eadb063c4d}{d\_Psiig\_dT}}\ =\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}*R*(-\/modelref.get\_Ar10(T,\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}},\ molefracs))\ +\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a96c231ca512122836b61f1b70e6514e8}{Psiig}}/T;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00539}00539\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ d\string^2(Psir)/dT\string^2\ =\ rho*R*(T*d2alphar/dT2\ +\ dalphar/dT\ +\ dalphar/dT)\ =\ rho*R*(T*d2alphar/dT2\ +\ 2*dalphar/dT)\ =\ rho*R/T*(T\string^2*d2alphar/dT2\ +\ 2*T*dalphar/dT)}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00540}00540\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ And\ from\ Eqs.\ 3.46\ and\ 3.47\ from\ Span\ we\ get\ A20\ for\ the\ term\ in\ (...)}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00541}00541\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a78b631c82363ced61d6735ca252ed706}{d2\_Psiig\_dT2}}\ =\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}*R/T*modelref.get\_Ar20(T,\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}},\ molefracs);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00542}00542\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a0036a8c962884007456e1b8d326cad14}{d2\_Psir\_dT2}}\ =\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}}*R/T*modelresid.get\_Ar20(T,\ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a433ed382705cecfab05367814759d5ed}{rho}},\ molefracs);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00543}00543\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_ac46fdac640049aaf38ea29d4c8044e3a}{gradient\_Psiig}}\ =\ modelref.build\_Psir\_gradient\_autodiff(T,\ rhovec);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00544}00544\ \ \ \ \ \ \ \ \ \ \ \ \ der.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1CaloricPhaseDerivatives_a53f0b5bf3911fa7a74e6ab6f16ccdf80}{d\_gradient\_Psiig\_dT}}\ =\ modelref.build\_d2PsirdTdrhoi\_autodiff(T,\ rhovec);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00545}00545\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ der;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00546}00546\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00547}00547\ \ \ \ \ \ \ \ \ std::vector<CaloricPhaseDerivatives>\ caloricderivatives;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00548}00548\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>idealgasptr)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00549}00549\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ iphase\_\ =\ 0;\ iphase\_\ <\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a34a85be03e70f101ada627fb8550d7d9}{Nphases}};\ ++iphase\_)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00550}00550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ caloricderivatives.emplace\_back(calculate\_caloric\_derivatives(*this-\/>idealgasptr-\/>get(),\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a7e754dd3559f068eff061a765c272edc}{residptr}},\ \ T,\ rhovecs[iphase\_]));}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00551}00551\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00552}00552\ \ \ \ \ \ \ \ \ \ \ \ \ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_ae364106dc883c22b05f2a2d01d63ab89}{derivatives}}\ =\ \&derivatives;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00553}00553\ \ \ \ \ \ \ \ \ \ \ \ \ sidecar.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1SpecificationSidecar_a4b6ffcce63a5943cfedf4d4da0c0c92f}{caloricderivatives}}\ =\ \&caloricderivatives;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00554}00554\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00555}00555\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00556}00556\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ spec:\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a39d8d1ca812e9b9f8c133c302d5adf05}{specifications}})\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00557}00557\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ [r\_,\ J\_]\ =\ spec-\/>r\_Jacobian(x,\ sidecar);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00558}00558\ \ \ \ \ \ \ \ \ \ \ \ \ r[irow]\ =\ r\_;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00559}00559\ \ \ \ \ \ \ \ \ \ \ \ \ J.row(irow)\ =\ J\_;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00560}00560\ \ \ \ \ \ \ \ \ \ \ \ \ irow\ +=\ 1;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00561}00561\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00562}00562\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00563}00563\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Finally,\ zero\ out\ the\ rows\ and\ columns\ in\ the\ Jacobian\ where\ mole\ fractions\ are\ zero,\ which\ would\ otherwise\ cause\ issues}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00564}00564\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00565}\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a7dfca08a6f5a3eaa426bb9340a87498e}{00565}}\ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a7dfca08a6f5a3eaa426bb9340a87498e}{num\_Jacobian}}(\textcolor{keyword}{const}\ Eigen::ArrayXd\&\ x,\ \textcolor{keyword}{const}\ Eigen::ArrayXd\&\ dx)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00566}00566\ \ \ \ \ \ \ \ \ Eigen::MatrixXd\ J(\mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}},\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}});}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00567}00567\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_ac291dcade165fe12ea18570f963424c5}{call}}(x);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00568}00568\ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ r0\ =\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a421f8d13f8adb241f64b86432c45838d}{res}}.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4a4655d7af333cd67c6e27ab21aa8689}{r}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00569}00569\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a806adeff4139f4ec0d599fa15b01c609}{Nindependent}};\ ++i)\{}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00570}00570\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dx\_\ =\ (dx[i]\ !=\ 0)\ ?\ dx[i]\ :\ 1e-\/6;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00571}00571\ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ xplus\ =\ x;\ xplus[i]\ +=\ dx\_;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00572}00572\ \ \ \ \ \ \ \ \ \ \ \ \ Eigen::ArrayXd\ xminus\ =\ x;\ xminus[i]\ -\/=\ dx\_;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00573}00573\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_ac291dcade165fe12ea18570f963424c5}{call}}(xplus);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00574}00574\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ rplus\ =\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a421f8d13f8adb241f64b86432c45838d}{res}}.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4a4655d7af333cd67c6e27ab21aa8689}{r}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00575}00575\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_ac291dcade165fe12ea18570f963424c5}{call}}(xminus);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00576}00576\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ rminus\ =\ \mbox{\hyperlink{classteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_a421f8d13f8adb241f64b86432c45838d}{res}}.\mbox{\hyperlink{structteqp_1_1algorithms_1_1phase__equil_1_1GeneralizedPhaseEquilibrium_1_1CallResult_a4a4655d7af333cd67c6e27ab21aa8689}{r}};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00577}00577\ \ \ \ \ \ \ \ \ \ \ \ \ J.col(i)\ =\ (rplus\ -\/\ rminus)/(2*dx\_);}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00578}00578\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00579}00579\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ J;}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00580}00580\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00581}00581\ \};}
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00582}00582\ }
\DoxyCodeLine{\Hypertarget{phase__equil_8hpp_source_l00583}00583\ \}}

\end{DoxyCode}
