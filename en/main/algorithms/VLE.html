<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Phase equilibria &#8212; teqp 0.18.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/ntd2d.css?v=88d0a8bc" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script src="../_static/documentation_options.js?v=ba2e7b09"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="VLLE" href="VLLE.html" />
    <link rel="prev" title="Algorithms" href="index.html" />
  
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />


  <link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-3.6.2.min.js" type="text/javascript" defer="defer"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>


  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Phase-equilibria">
<h1>Phase equilibria<a class="headerlink" href="#Phase-equilibria" title="Link to this heading">¶</a></h1>
<p>Two basic approaches are implemented in teqp:</p>
<ul class="simple">
<li><p>Iterative calculations given guess values</p></li>
<li><p>Tracing along iso-curves (constant temperature, etc.) powered by the isochoric thermodynamics formalism</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">teqp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">teqp</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;0.18.0&#39;
</pre></div></div>
</div>
<section id="Iterative-Phase-Equilibria">
<h2>Iterative Phase Equilibria<a class="headerlink" href="#Iterative-Phase-Equilibria" title="Link to this heading">¶</a></h2>
<section id="Pure-fluid">
<h3>Pure fluid<a class="headerlink" href="#Pure-fluid" title="Link to this heading">¶</a></h3>
<p>For a pure fluid, phase equilibrium between two phases is defined by equating the pressures and Gibbs energies in the two phases. This represents a 2D non-linear rootfinding problem. Newton’s method can be used for the rootfinding, and in teqp, automatic differentiation is used to obtain the necessary Jacobian matrix so the implementation is quite efficient.</p>
<p>The method requires guess values, which are the densities of the liquid and vapor densities. In some cases, ancillary or superancillary equations have been developed which provide curves of guess densities as a function of temperature.</p>
<p>For a pure fluid, you can use the <code class="docutils literal notranslate"><span class="pre">pure_VLE_T</span></code> method to carry out the iteration.</p>
<p>The Python method is here: <code class="xref py py-meth docutils literal notranslate"><span class="pre">pure_VLE_T</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">teqp</span><span class="o">.</span><span class="n">canonical_PR</span><span class="p">([</span><span class="mi">300</span><span class="p">],</span> <span class="p">[</span><span class="mf">4e6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">])</span>

<span class="n">T</span> <span class="o">=</span> <span class="mi">250</span> <span class="c1"># [K], Temperature to be used</span>

<span class="c1"># Here we use the superancillary to get guess values (actually these are more</span>
<span class="c1"># accurate than the results we will obtain from iteration!)</span>
<span class="n">rhoL0</span><span class="p">,</span> <span class="n">rhoV0</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">superanc_rhoLV</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;guess:&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rhoL0</span><span class="p">,</span> <span class="n">rhoV0</span><span class="p">])</span>

<span class="c1"># Carry out the iteration, return the liquid and vapor densities</span>
<span class="c1"># The guess values are perturbed to make sure the iteration is actually</span>
<span class="c1"># changing the values</span>
<span class="n">model</span><span class="o">.</span><span class="n">pure_VLE_T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">rhoL0</span><span class="o">*</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">rhoV0</span><span class="o">*</span><span class="mf">1.02</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;guess:&#39;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[12735.311173407898, 752.4082303122791]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([12735.31117341,   752.40823031])
</pre></div></div>
</div>
</section>
<section id="Binary-Mixture">
<h3>Binary Mixture<a class="headerlink" href="#Binary-Mixture" title="Link to this heading">¶</a></h3>
<p>For a binary mixture, the approach is roughly similar to that of a pure fluid. The pressure is equated between phases, and the chemical potentials of each component in each phase are forced to be the same.</p>
<p>Again, the user is required to provide guess values, in this case molar concentrations in each phase, and a Newton method is implemented to solve for the phase equilibrium. The analytical Jacobian is obtained from automatic differentiation.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mix_VLE_Tx</span></code> function is the binary mixture analog to <code class="docutils literal notranslate"><span class="pre">pure_VLE_T</span></code> for pure fluids.</p>
<p>The Python method is here: <code class="xref py py-meth docutils literal notranslate"><span class="pre">mix_VLE_Tx</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">teqp</span><span class="o">.</span><span class="n">canonical_PR</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span><span class="mi">310</span><span class="p">],</span> <span class="p">[</span><span class="mf">4e6</span><span class="p">,</span><span class="mf">4.5e6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">teqp</span><span class="o">.</span><span class="n">canonical_PR</span><span class="p">([</span><span class="mi">300</span><span class="p">],</span> <span class="p">[</span><span class="mf">4e6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">273.0</span> <span class="c1"># [K]</span>
<span class="c1"># start off at pure of the first component</span>
<span class="n">rhoL0</span><span class="p">,</span> <span class="n">rhoV0</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">superanc_rhoLV</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>

<span class="c1"># then we shift to the given composition in the first phase</span>
<span class="c1"># to get guess values</span>
<span class="n">rhovecA0</span> <span class="o">=</span> <span class="n">rhoL0</span><span class="o">*</span><span class="n">zA</span>
<span class="n">rhovecB0</span> <span class="o">=</span> <span class="n">rhoV0</span><span class="o">*</span><span class="n">zA</span>

<span class="c1"># carry out the iteration</span>
<span class="n">code</span><span class="p">,</span> <span class="n">rhovecA</span><span class="p">,</span> <span class="n">rhovecB</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">mix_VLE_Tx</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">rhovecA0</span><span class="p">,</span> <span class="n">rhovecB0</span><span class="p">,</span> <span class="n">zA</span><span class="p">,</span>
     <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span>  <span class="c1"># stopping conditions</span>
     <span class="mi">10</span> <span class="c1"># maximum number of iterations</span>
    <span class="p">)</span>
<span class="n">code</span><span class="p">,</span> <span class="n">rhovecA</span><span class="p">,</span> <span class="n">rhovecB</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;VLE_return_code.xtol_satisfied: 1&gt;,
 array([  128.66049209, 12737.38871682]),
 array([  12.91868229, 1133.77242677]))
</pre></div></div>
</div>
<p>You can (and should) check the value of the return code to make sure the iteration succeeded. Do not rely on the numerical value of the enumerated return codes!</p>
</section>
</section>
</section>
<section id="Tracing-(isobars-and-isotherms)">
<h1>Tracing (isobars and isotherms)<a class="headerlink" href="#Tracing-(isobars-and-isotherms)" title="Link to this heading">¶</a></h1>
<p>When it comes to mixture thermodynamics, as soon as you add another component to a pure component to form a binary mixture, the complexity of the thermodynamics entirely changes. For that reason, mixture iterative calculations for mixtures are orders of magnitude more difficult to carry out. Asymmetric mixtures can do all sorts of interesting things that are entirely unlike those of pure fluids, and the algorithms are therefore much, much more complicated. Formulating phase equilibrium problems
is not much more complicated than for pure fluids, but the most challenging aspect is to obtain good guess values from which to start an iterative routine, and the difficulty of this problem increases with the complexity of the mixture thermodynamics.</p>
<p>Ulrich Deiters and Ian Bell have developed a number of algorithms for tracing phase equilibrium solutions as the solution of ordinary differential equations rather than carrying out iterative routines for a given state point. The advantage of the tracing calculations is that they can often be initiated at a state point that is entirely known, for instance the pure fluid endpoint for a subcritical isotherm or isobar.</p>
<p>The Python method is here: <code class="xref py py-meth docutils literal notranslate"><span class="pre">trace_VLE_isotherm_binary</span></code></p>
<p>The C++ implementation returns a string in JSON format, which can be conveniently operated upon, for instance after converting the returned data structure to a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>. A simple example of plotting a subcritical isotherm for a “boring” mixture is presented here:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">teqp</span><span class="o">.</span><span class="n">canonical_PR</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span><span class="mi">310</span><span class="p">],</span> <span class="p">[</span><span class="mf">4e6</span><span class="p">,</span><span class="mf">4.5e6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">teqp</span><span class="o">.</span><span class="n">canonical_PR</span><span class="p">([</span><span class="mi">300</span><span class="p">],</span> <span class="p">[</span><span class="mf">4e6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">273.0</span> <span class="c1"># [K]</span>
<span class="n">rhoL0</span><span class="p">,</span> <span class="n">rhoV0</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">superanc_rhoLV</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="c1"># start off at pure of the first component</span>
<span class="n">j</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">trace_VLE_isotherm_binary</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rhoL0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rhoV0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="n">display</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;...&#39;</span><span class="p">)</span> <span class="c1"># The first few bits of the data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="c1"># Now as a data frame</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#34;[{&#39;T / K&#39;: 273.0, &#39;c&#39;: -1.0, &#39;drho/dt&#39;: [-0.618312383229212, 0.7690760182230469, -0.1277526773161415...&#34;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T / K</th>
      <th>c</th>
      <th>drho/dt</th>
      <th>dt</th>
      <th>pL / Pa</th>
      <th>pV / Pa</th>
      <th>rhoL / mol/m^3</th>
      <th>rhoV / mol/m^3</th>
      <th>t</th>
      <th>xL_0 / mole frac.</th>
      <th>xV_0 / mole frac.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>273.0</td>
      <td>-1.0</td>
      <td>[-0.618312383229212, 0.7690760182230469, -0.12...</td>
      <td>0.000010</td>
      <td>2.203397e+06</td>
      <td>2.203397e+06</td>
      <td>[10697.985891540735, 0.0]</td>
      <td>[1504.6120879290752, 0.0]</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>273.0</td>
      <td>-1.0</td>
      <td>[-0.6183123817120353, 0.7690760162922189, -0.1...</td>
      <td>0.000045</td>
      <td>2.203397e+06</td>
      <td>2.203397e+06</td>
      <td>[10697.985885357639, 7.690760309421386e-06]</td>
      <td>[1504.6120866515366, 9.945415375682985e-07]</td>
      <td>0.000010</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>273.0</td>
      <td>-1.0</td>
      <td>[-0.6183123827116788, 0.7690760173388914, -0.1...</td>
      <td>0.000203</td>
      <td>2.203397e+06</td>
      <td>2.203397e+06</td>
      <td>[10697.98585753358, 4.229918121248511e-05]</td>
      <td>[1504.6120809026731, 5.469978386095445e-06]</td>
      <td>0.000055</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;xL_0 / mole frac.&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;pL / Pa&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;xV_0 / mole frac.&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;pL / Pa&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$x_1,y_1$ / mole frac.&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;p / MPa&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/algorithms_VLE_15_0.png" src="../_images/algorithms_VLE_15_0.png" />
</div>
</div>
<p>Isn’t that exciting!</p>
<p>You can also provide an optional set of flags to the function to control other behaviors of the function, and switch between simple Euler and adaptive RK45 integration (the default)</p>
<p>The options class is here: <a class="reference internal" href="../api/teqp.html#teqp.teqp.TVLEOptions" title="teqp.teqp.TVLEOptions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TVLEOptions</span></code></a></p>
<p>Supercritical isotherms work approximately in the same manner</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tc_K</span> <span class="o">=</span> <span class="p">[</span><span class="mf">190.564</span><span class="p">,</span> <span class="mf">154.581</span><span class="p">]</span>
<span class="n">pc_Pa</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4599200</span><span class="p">,</span> <span class="mi">5042800</span><span class="p">]</span>
<span class="n">acentric</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.011</span><span class="p">,</span> <span class="mf">0.022</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">teqp</span><span class="o">.</span><span class="n">canonical_PR</span><span class="p">(</span><span class="n">Tc_K</span><span class="p">,</span> <span class="n">pc_Pa</span><span class="p">,</span> <span class="n">acentric</span><span class="p">)</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">teqp</span><span class="o">.</span><span class="n">canonical_PR</span><span class="p">([</span><span class="n">Tc_K</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">pc_Pa</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">acentric</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">170.0</span> <span class="c1"># [K] # Note: above Tc of the second component</span>
<span class="n">rhoL0</span><span class="p">,</span> <span class="n">rhoV0</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">superanc_rhoLV</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="c1"># start off at pure of the first component</span>
<span class="n">j</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">trace_VLE_isotherm_binary</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rhoL0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rhoV0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="c1"># Now as a data frame</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;xL_0 / mole frac.&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;pL / Pa&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;xV_0 / mole frac.&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;pL / Pa&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$x_1,y_1$ / mole frac.&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;p / MPa&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/algorithms_VLE_19_0.png" src="../_images/algorithms_VLE_19_0.png" />
</div>
</div>
<p>As of version 0.10.0, isobar tracing has been added to <code class="docutils literal notranslate"><span class="pre">teqp</span></code>. It operates in fundamentally the same fashion as the isotherm tracing and the same recommendations about starting at a pure fluid apply</p>
<p>The tracer function class is here: <code class="xref py py-meth docutils literal notranslate"><span class="pre">trace_VLE_isobar_binary</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tc_K</span> <span class="o">=</span> <span class="p">[</span><span class="mf">190.564</span><span class="p">,</span> <span class="mf">154.581</span><span class="p">]</span>
<span class="n">pc_Pa</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4599200</span><span class="p">,</span> <span class="mi">5042800</span><span class="p">]</span>
<span class="n">acentric</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.011</span><span class="p">,</span> <span class="mf">0.022</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">teqp</span><span class="o">.</span><span class="n">canonical_PR</span><span class="p">(</span><span class="n">Tc_K</span><span class="p">,</span> <span class="n">pc_Pa</span><span class="p">,</span> <span class="n">acentric</span><span class="p">)</span>
<span class="n">model1</span> <span class="o">=</span> <span class="n">teqp</span><span class="o">.</span><span class="n">canonical_PR</span><span class="p">([</span><span class="n">Tc_K</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">pc_Pa</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">acentric</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">170.0</span> <span class="c1"># [K] # Note: above Tc of the second component</span>
<span class="n">rhoL0</span><span class="p">,</span> <span class="n">rhoV0</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">superanc_rhoLV</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="c1"># start off at pure of the first component</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">rhoL0</span><span class="o">*</span><span class="n">model1</span><span class="o">.</span><span class="n">get_R</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]))</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">model1</span><span class="o">.</span><span class="n">get_Ar01</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">rhoL0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])))</span>
<span class="n">j</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">trace_VLE_isobar_binary</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rhoL0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rhoV0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="c1"># Now as a data frame</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;xL_0 / mole frac.&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;T / K&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;xV_0 / mole frac.&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;T / K&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$x_1,y_1$ / mole frac.&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;T / K&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/algorithms_VLE_22_0.png" src="../_images/algorithms_VLE_22_0.png" />
</div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Phase equilibria</a><ul>
<li><a class="reference internal" href="#Iterative-Phase-Equilibria">Iterative Phase Equilibria</a><ul>
<li><a class="reference internal" href="#Pure-fluid">Pure fluid</a></li>
<li><a class="reference internal" href="#Binary-Mixture">Binary Mixture</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Tracing-(isobars-and-isotherms)">Tracing (isobars and isotherms)</a></li>
</ul>

  </div><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Algorithms</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Algorithms</a></li>
      <li>Next: <a href="VLLE.html" title="next chapter">VLLE</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/algorithms/VLE.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

  
    <div class="footer">
      &copy;2022, Ian Bell.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/algorithms/VLE.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    

  <!-- Taken from https://www.filamentgroup.com/lab/html-includes/#another-demo%3A-including-another-html-file -->
  <iframe src="../_static/ntd2d_menu.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>
  </body>
</html>