\doxysection{quadrature.\+hpp}
\hypertarget{quadrature_8hpp_source}{}\label{quadrature_8hpp_source}\index{include/teqp/math/quadrature.hpp@{include/teqp/math/quadrature.hpp}}
\mbox{\hyperlink{quadrature_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00006}00006\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00008}00008\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceteqp}{teqp}}\{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00015}00015\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ N,\ \textcolor{keyword}{typename}\ T,\ \textcolor{keyword}{typename}\ Double=\textcolor{keywordtype}{double}>}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00016}\mbox{\hyperlink{namespaceteqp_a9c9294e48d5b5ae2258bb0f19c1d0d48}{00016}}\ \textcolor{keyword}{inline}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespaceteqp_a9c9294e48d5b5ae2258bb0f19c1d0d48}{quad}}(\textcolor{keyword}{const}\ std::function<T(Double)>\&\ F,\ \textcolor{keyword}{const}\ Double\&\ a,\ \textcolor{keyword}{const}\ Double\&\ b)\{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00017}00017\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00018}00018\ \ \ \ \ \textcolor{comment}{//\ Locations\ x\ in\ [-\/1,1]\ where\ the\ function\ is\ to\ be\ evaluated,\ and\ the\ corresponding\ weight}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00019}00019\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ std::map<int,\ std::tuple<std::vector<Double>,\ std::vector<Double>>>\ xw\ =\ \{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00020}00020\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00021}00021\ \ \ \ \ \ \ \ \ \ \ \ \ 3,}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00022}00022\ \ \ \ \ \ \ \ \ \ \ \ \ \{\{\ 0,\ sqrt(3.0/5),\ -\/sqrt(3.0/5)\ \},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00023}00023\ \ \ \ \ \ \ \ \ \ \ \ \ \{8.0/9.0,\ 5.0/9.0,\ 5.0/9.0\}\}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00024}00024\ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00025}00025\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00026}00026\ \ \ \ \ \ \ \ \ \ \ \ \ 4,}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00027}00027\ \ \ \ \ \ \ \ \ \ \ \ \ \{\{sqrt(3.0/7.0-\/2.0/7.0*sqrt(6.0/5)),\ -\/sqrt(3.0/7.0-\/2.0/7.0*sqrt(6.0/5)),\ sqrt(3.0/7.0+2.0/7.0*sqrt(6.0/5)),\ -\/sqrt(3.0/7.0+2.0/7.0*sqrt(6.0/5))\},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00028}00028\ \ \ \ \ \ \ \ \ \ \ \ \ \{(18.0+sqrt(30.0))/36.0,\ (18.0+sqrt(30.0))/36.0,\ (18.0-\/sqrt(30.0))/36.0,\ (18.0-\/sqrt(30.0))/36.0\}\}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00029}00029\ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00030}00030\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ 5,}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ \{\{0,\ 1.0/3.0*sqrt(5-\/2*sqrt(10.0/7.0)),\ -\/1.0/3.0*sqrt(5-\/2*sqrt(10.0/7.0)),\ 1.0/3.0*sqrt(5+2*sqrt(10.0/7.0)),\ -\/1.0/3.0*sqrt(5+2*sqrt(10.0/7.0))\},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \{128/225.0,\ (322.0+13*sqrt(70))/900.0,\ (322.0+13*sqrt(70))/900.0,\ (322.0-\/13*sqrt(70))/900.0,\ (322.0-\/13*sqrt(70))/900.0\}\}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00034}00034\ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00035}00035\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ 7,}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \{\{0.0000000000000000,0.4058451513773972,-\/0.4058451513773972,-\/0.7415311855993945,0.7415311855993945,-\/0.9491079123427585,0.9491079123427585\},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \{\ 0.4179591836734694,0.3818300505051189,0.3818300505051189,0.2797053914892766,0.2797053914892766,0.1294849661688697,0.1294849661688697\}\}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00039}00039\ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00040}00040\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ 10,}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \{\{-\/0.1488743389816312,0.1488743389816312,-\/0.4333953941292472,0.4333953941292472,-\/0.6794095682990244,0.6794095682990244,-\/0.8650633666889845,0.8650633666889845,-\/0.9739065285171717,0.9739065285171717\},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ \{\ 0.2955242247147529,0.2955242247147529,0.2692667193099963,0.2692667193099963,0.2190863625159820,0.2190863625159820,0.1494513491505806,0.1494513491505806,0.0666713443086881,0.0666713443086881\}\}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00044}00044\ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00045}00045\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ 15,}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \{\{0.0000000000000000,-\/0.2011940939974345,0.2011940939974345,-\/0.3941513470775634,0.3941513470775634,-\/0.5709721726085388,0.5709721726085388,-\/0.7244177313601701,0.7244177313601701,-\/0.8482065834104272,0.8482065834104272,-\/0.9372733924007060,0.9372733924007060,-\/0.9879925180204854,0.9879925180204854\},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ \{0.2025782419255613,0.1984314853271116,0.1984314853271116,0.1861610000155622,0.1861610000155622,0.1662692058169939,0.1662692058169939,0.1395706779261543,0.1395706779261543,0.1071592204671719,0.1071592204671719,0.0703660474881081,0.0703660474881081,0.0307532419961173,0.0307532419961173\}\}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00049}00049\ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00050}00050\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ 30,}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00052}00052\ \ \ \ \ \ \ \ \ \ \ \ \ \{\{-\/0.0514718425553177,0.0514718425553177,-\/0.1538699136085835,0.1538699136085835,-\/0.2546369261678899,0.2546369261678899,-\/0.3527047255308781,0.3527047255308781,-\/0.4470337695380892,0.4470337695380892,-\/0.5366241481420199,0.5366241481420199,-\/0.6205261829892429,0.6205261829892429,-\/0.6978504947933158,0.6978504947933158,-\/0.7677774321048262,0.7677774321048262,-\/0.8295657623827684,0.8295657623827684,-\/0.8825605357920527,0.8825605357920527,-\/0.9262000474292743,0.9262000474292743,-\/0.9600218649683075,0.9600218649683075,-\/0.9836681232797472,0.9836681232797472,-\/0.9968934840746495,0.9968934840746495}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \{0.1028526528935588,0.1028526528935588,0.1017623897484055,0.1017623897484055,0.0995934205867953,0.0995934205867953,0.0963687371746443,0.0963687371746443,0.0921225222377861,0.0921225222377861,0.0868997872010830,0.0868997872010830,0.0807558952294202,0.0807558952294202,0.0737559747377052,0.0737559747377052,0.0659742298821805,0.0659742298821805,0.0574931562176191,0.0574931562176191,0.0484026728305941,0.0484026728305941,0.0387991925696271,0.0387991925696271,0.0287847078833234,0.0287847078833234,0.0184664683110910,0.0184664683110910,0.0079681924961666,0.0079681924961666\}\}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00055}00055\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00056}00056\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00057}00057\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00058}00058\ \ \ \ \ T\ summer\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00059}00059\ \ \ \ \ \textcolor{comment}{//\ Lookup\ the\ coefficients\ without\ making\ a\ copy\ or\ re-\/allocating}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00060}00060\ \ \ \ \ \textcolor{keyword}{const}\ std::tuple<std::vector<Double>,\ std::vector<Double>>\ \&pair\ =\ xw.at(N);}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00061}00061\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<Double>\ \&x\ =\ std::get<0>(pair);}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00062}00062\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<Double>\ \&w\ =\ std::get<1>(pair);}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00063}00063\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ 0;\ i\ <\ N;\ ++i)\{}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00064}00064\ \ \ \ \ \ \ \ \ Double\ arg\ =\ (b-\/a)/2.0*x[i]\ +\ (a+b)/2.0;}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00065}00065\ \ \ \ \ \ \ \ \ summer\ +=\ w[i]*F(arg);}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00066}00066\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00067}00067\ \ \ \ \ T\ retval\ =\ (b-\/a)/2.0*summer;\ \textcolor{comment}{//\ Forces\ a\ flattening\ if\ T\ is\ an\ autodiff\ type}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00068}00068\ \ \ \ \ \textcolor{keywordflow}{return}\ retval;}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00069}00069\ \}}
\DoxyCodeLine{\Hypertarget{quadrature_8hpp_source_l00070}00070\ \}}

\end{DoxyCode}
