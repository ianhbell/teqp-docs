\doxysection{ancillary\+\_\+builder.\+hpp}
\hypertarget{ancillary__builder_8hpp_source}{}\label{ancillary__builder_8hpp_source}\index{include/teqp/algorithms/ancillary\_builder.hpp@{include/teqp/algorithms/ancillary\_builder.hpp}}
\mbox{\hyperlink{ancillary__builder_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00001}00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00005}00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{teqpcpp_8hpp}{teqp/cpp/teqpcpp.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00006}00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{multifluid__ancillaries_8hpp}{teqp/models/multifluid\_ancillaries.hpp}}"{}}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00008}\mbox{\hyperlink{namespaceteqp}{00008}}\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceteqp}{teqp}}\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00009}\mbox{\hyperlink{namespaceteqp_1_1ancillaries}{00009}}\ \textcolor{keyword}{namespace\ }ancillaries\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00011}00011\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespaceteqp}{teqp}};}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00012}00012\ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespaceteqp_1_1cppinterface}{teqp::cppinterface}};}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00014}\mbox{\hyperlink{namespaceteqp_1_1ancillaries_a94a3932001b7734388650f1352491af1}{00014}}\ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespaceteqp_1_1ancillaries_a94a3932001b7734388650f1352491af1}{build\_ancillaries}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel}{AbstractModel}}\&\ model,\ \textcolor{keywordtype}{double}\ Tcritguess,\ \textcolor{keywordtype}{double}\ rhocritguess,\ \textcolor{keywordtype}{double}\ Tmin,\ std::optional<nlohmann::json>\ flags\_\ =\ std::nullopt)}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00015}00015\ \{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00016}00016\ \ \ \ \ nlohmann::json\ flags\ =\ flags\_.value\_or(nlohmann::json::object());}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00017}00017\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00018}00018\ \ \ \ \ \textcolor{keywordtype}{bool}\ ii\ =\ flags.is\_object();}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00019}00019\ \ \ \ \ \textcolor{keywordtype}{bool}\ verify\ =\ flags.value(\textcolor{stringliteral}{"{}verify"{}},\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00020}00020\ \ \ \ \ \textcolor{keywordtype}{int}\ Npts\ =\ flags.value(\textcolor{stringliteral}{"{}Npts"{}},\ 1000);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00021}00021\ \ \ \ \ \textcolor{keywordtype}{double}\ Theta\_nearcrit\ =\ flags.value(\textcolor{stringliteral}{"{}Theta\_nearcrit"{}},\ 0.01);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00022}00022\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00023}00023\ \ \ \ \ \textcolor{keyword}{auto}\ [Tcrittrue,\ rhocrittrue]\ =\ model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_aad84ac400f0003843c8a780e51a8361c}{solve\_pure\_critical}}(Tcritguess,\ rhocritguess);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00024}00024\ \ \ \ \ \textcolor{keywordtype}{double}\ Tclosec\ =\ (1-\/Theta\_nearcrit)*Tcrittrue;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00025}00025\ \ \ \ \ \textcolor{keyword}{auto}\ rhovec\ =\ model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_af0b347b5c539106f934ce82a8e9d6d81}{extrapolate\_from\_critical}}(Tcrittrue,\ rhocrittrue,\ Tclosec);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00026}00026\ \ \ \ \ \textcolor{keywordtype}{double}\ rhoL\ =\ rhovec[0],\ rhoV\ =\ rhovec[1];}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00027}00027\ \ \ \ \ \textcolor{keyword}{auto}\ molefrac\ =\ (Eigen::ArrayXd(1)\ <<\ 1.0).finished();}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00028}00028\ \ \ \ \ \textcolor{keywordtype}{double}\ R\ =\ model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_a38884acb6a2663fe18967760e9438b68}{get\_R}}(molefrac);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00029}00029\ \ \ \ \ \textcolor{keywordtype}{double}\ pcrittrue\ =\ rhocrittrue*R*Tcrittrue*(1+model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_a0ce44e70fa200a4a1480d826d23ec016}{get\_Ar01}}(Tcrittrue,\ rhocrittrue,\ molefrac));}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00030}00030\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00031}00031\ \ \ \ \ \textcolor{keywordtype}{double}\ dT\ =\ (Tcrittrue-\/Tmin)/(Npts-\/1);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00032}00032\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00033}00033\ \ \ \ \ \textcolor{comment}{//\ Convenience\ function\ to\ get\ the\ density\ derivatives}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00034}00034\ \ \ \ \ \textcolor{keyword}{auto}\ getdrhodTs\ =\ [\&R,\ \&molefrac](\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ model,\ \textcolor{keywordtype}{double}\ T,\ \textcolor{keywordtype}{double}\ rhoL,\ \textcolor{keywordtype}{double}\ rhoV)\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dpsatdT\ =\ model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_a2c83cb61de2994adaa0770539bb988bd}{dpsatdT\_pure}}(T,\ rhoL,\ rhoV);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00037}00037\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ get\_drhodT\ =\ [\&](\textcolor{keywordtype}{double}\ T,\ \textcolor{keywordtype}{double}\ rho)\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dpdrho\ =\ R*T*(1\ +\ 2*model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_a0ce44e70fa200a4a1480d826d23ec016}{get\_Ar01}}(T,\ rho,\ molefrac)\ +\ model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_a58ed79bc64422464baf6ff59cc320bb1}{get\_Ar02}}(T,\ rho,\ molefrac));}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ dpdT\ =\ R*rho*(1\ +\ model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_a0ce44e70fa200a4a1480d826d23ec016}{get\_Ar01}}(T,\ rho,\ molefrac)\ -\/\ model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_addb6f068a25fe00ad6f14f49dbb81933}{get\_Ar11}}(T,\ rho,\ molefrac));}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/dpdT/dpdrho\ +\ dpsatdT/dpdrho;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00041}00041\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00043}00043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::make\_tuple(get\_drhodT(T,\ rhoL),\ get\_drhodT(T,\ rhoV));}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00044}00044\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00045}00045\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00046}00046\ \ \ \ \ std::vector<double>\ Thetas\_,\ rhoLs\_,\ rhoVs\_,\ pLs\_;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00047}00047\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ Npts;\ ++i)\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ T\ =\ Tclosec\ -\/\ dT*i;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00049}00049\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ rhovec\ =\ model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_aa7fcd91d9a54b7e6d3d745be73c64eee}{pure\_VLE\_T}}(T,\ rhoL,\ rhoV,\ 10);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00050}00050\ \ \ \ \ \ \ \ \ rhoL\ =\ rhovec[0];\ rhoV\ =\ rhovec[1];}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ [drhodTL,\ drhodTV]\ =\ getdrhodTs(model,\ T,\ rhoL,\ rhoV);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00052}00052\ \ \ \ \ \ \ \ \ rhoL\ +=\ drhodTL*dT;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00053}00053\ \ \ \ \ \ \ \ \ rhoV\ +=\ drhodTV*dT;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00054}00054\ \ \ \ \ \ \ \ \ T\ +=\ dT;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00055}00055\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ Theta\ =\ (Tcrittrue-\/T)/Tcrittrue;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00056}00056\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ pL\ =\ rhoL*R*T*(1+model.\mbox{\hyperlink{classteqp_1_1cppinterface_1_1AbstractModel_a0ce44e70fa200a4a1480d826d23ec016}{get\_Ar01}}(T,\ rhoL,\ molefrac));}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00057}00057\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00058}00058\ \ \ \ \ \ \ \ \ Thetas\_.push\_back(Theta);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00059}00059\ \ \ \ \ \ \ \ \ rhoLs\_.push\_back(rhoL);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00060}00060\ \ \ \ \ \ \ \ \ rhoVs\_.push\_back(rhoV);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00061}00061\ \ \ \ \ \ \ \ \ pLs\_.push\_back(pL);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00062}00062\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00063}00063\ \ \ \ \ \textcolor{keyword}{auto}\ N\ =\ Thetas\_.size();}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00064}00064\ \ \ \ \ \textcolor{keyword}{auto}\ pLs\ =\ Eigen::Map<Eigen::ArrayXd>(\&(pLs\_[0]),\ N);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00065}00065\ \ \ \ \ \textcolor{keyword}{auto}\ rhoLs\ =\ Eigen::Map<Eigen::ArrayXd>(\&(rhoLs\_[0]),\ N);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00066}00066\ \ \ \ \ \textcolor{keyword}{auto}\ rhoVs\ =\ Eigen::Map<Eigen::ArrayXd>(\&(rhoVs\_[0]),\ N);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00067}00067\ \ \ \ \ \textcolor{keyword}{auto}\ Thetass\ =\ Eigen::Map<Eigen::ArrayXd>(\&(Thetas\_[0]),\ N);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00068}00068\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00069}00069\ \ \ \ \ \textcolor{comment}{//\ Solve\ the\ least-\/squares\ problem\ for\ the\ polynomial\ coefficients}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00070}00070\ \ \ \ \ Eigen::ArrayXd\ exponents\ =\ Eigen::ArrayXd::LinSpaced(10,\ 0,\ 4.5);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00071}00071\ \ \ \ \ Eigen::MatrixXd\ A(N,exponents.size());}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00072}00072\ \ \ \ \ Eigen::VectorXd\ bL(N),\ bV(N),\ bpL(N);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00073}00073\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ 0;\ i\ <\ exponents.size();\ ++i)\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00074}00074\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ \mbox{\hyperlink{namespaceteqp_1_1cppinterface_1_1adapter_a39a57d164c9ab5bc08627135ad8f7930}{view}}\ =\ (Eigen::Map<Eigen::ArrayXd>(\&(Thetass[0]),\ N));}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00075}00075\ \ \ \ \ \ \ \ \ A.col(i)\ =\ \mbox{\hyperlink{namespaceteqp_1_1cppinterface_1_1adapter_a39a57d164c9ab5bc08627135ad8f7930}{view}}.pow(exponents[i]);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00076}00076\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00077}00077\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00078}00078\ \ \ \ \ bL\ =\ (rhoLs/rhocrittrue)-\/1;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00079}00079\ \ \ \ \ \textcolor{keyword}{auto}\ TTr\ =\ 1.0-\/Thetass;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00080}00080\ \ \ \ \ bV\ =\ (rhoVs/rhocrittrue).log()*TTr;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00081}00081\ \ \ \ \ bpL\ =\ (pLs/pcrittrue).log()*TTr;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00082}00082\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00083}00083\ \ \ \ \ Eigen::ArrayXd\ cLarray\ =\ A.colPivHouseholderQr().solve(bL).array();}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00084}00084\ \ \ \ \ Eigen::ArrayXd\ cVarray\ =\ A.colPivHouseholderQr().solve(bV).array();}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00085}00085\ \ \ \ \ Eigen::ArrayXd\ cpLarray\ =\ A.colPivHouseholderQr().solve(bpL).array();}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00086}00086\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00087}00087\ \ \ \ \ \textcolor{keyword}{auto}\ toj\ =\ [](\textcolor{keyword}{const}\ Eigen::ArrayXd\&\ a)\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00088}00088\ \ \ \ \ \ \ \ \ std::vector<double>\ o(a.size());}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00089}00089\ \ \ \ \ \ \ \ \ Eigen::Map<Eigen::ArrayXd>(\&(o[0]),\ o.size())\ =\ a;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00090}00090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ o;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00091}00091\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00092}00092\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00093}00093\ \ \ \ \ nlohmann::json\ jrhoL\ =\ \{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00094}00094\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}T\_r"{}},\ Tcrittrue\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00095}00095\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}Tmax"{}},\ Tcrittrue\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00096}00096\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}Tmin"{}},\ Tmin\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00097}00097\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}type"{}},\ \textcolor{stringliteral}{"{}rhoLnoexp"{}}\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00098}00098\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}description"{}},\ \textcolor{stringliteral}{"{}I'm\ a\ description"{}}\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00099}00099\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}n"{}},\ toj(cLarray)\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00100}00100\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}t"{}},\ toj(exponents)\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00101}00101\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}reducing\_value"{}},\ rhocrittrue\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00102}00102\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}using\_tau\_r"{}},\ \textcolor{keyword}{false}\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00103}00103\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00104}00104\ \ \ \ \ nlohmann::json\ jrhoV\ =\ \{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00105}00105\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}T\_r"{}},\ Tcrittrue\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00106}00106\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}Tmax"{}},\ Tcrittrue\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00107}00107\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}Tmin"{}},\ Tmin\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00108}00108\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}type"{}},\ \textcolor{stringliteral}{"{}type"{}}\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00109}00109\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}description"{}},\ \textcolor{stringliteral}{"{}I'm\ a\ description"{}}\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00110}00110\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}n"{}},\ toj(cVarray)\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00111}00111\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}t"{}},\ toj(exponents)\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00112}00112\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}reducing\_value"{}},\ rhocrittrue\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00113}00113\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}using\_tau\_r"{}},\ \textcolor{keyword}{true}\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00114}00114\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00115}00115\ \ \ \ \ nlohmann::json\ jpsat\ =\ \{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00116}00116\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}T\_r"{}},\ Tcrittrue\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00117}00117\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}Tmax"{}},\ Tcrittrue\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00118}00118\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}Tmin"{}},\ Tmin\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00119}00119\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}type"{}},\ \textcolor{stringliteral}{"{}type"{}}\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00120}00120\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}description"{}},\ \textcolor{stringliteral}{"{}I'm\ a\ description"{}}\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00121}00121\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}n"{}},\ toj(cpLarray)\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00122}00122\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}t"{}},\ toj(exponents)\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00123}00123\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}reducing\_value"{}},\ pcrittrue\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00124}00124\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}using\_tau\_r"{}},\ \textcolor{keyword}{true}\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00125}00125\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00126}00126\ \ \ \ \ nlohmann::json\ j\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00127}00127\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}rhoL"{}},\ jrhoL\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00128}00128\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}rhoV"{}},\ jrhoV\},}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00129}00129\ \ \ \ \ \ \ \ \ \{\textcolor{stringliteral}{"{}pS"{}},\ jpsat\}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00130}00130\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00131}00131\ \ \ \ \ \textcolor{keyword}{auto}\ anc\ =\ \mbox{\hyperlink{structteqp_1_1MultiFluidVLEAncillaries}{MultiFluidVLEAncillaries}}(j);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00132}00132\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00133}00133\ \ \ \ \ \textcolor{keywordflow}{if}\ (verify)\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verify}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00135}00135\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ i\ =\ 0;\ i\ <\ Thetas\_.size();\ ++i)\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ T\ =\ (1-\/Thetas\_[i])*Tcrittrue;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ rhoLanc\ =\ anc.rhoL(T);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ rhoVanc\ =\ anc.rhoV(T);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ panc\ =\ anc.pL(T);}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::abs(rhoLanc/rhoLs\_[i]-\/1)\ >\ 1e-\/2)\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ T\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ rhoLs\_[i]\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ rhoLanc\ <<\ std::endl;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::abs(rhoVanc/rhoVs\_[i]-\/1)\ >\ 1e-\/2)\{}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ T\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ rhoVs\_[i]\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ rhoVanc\ <<\ std::endl;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00147}00147\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00148}00148\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00149}00149\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00150}00150\ \ \ \ \ \textcolor{keywordflow}{return}\ anc;}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00151}00151\ \}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00153}00153\ }
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00154}00154\ \}}
\DoxyCodeLine{\Hypertarget{ancillary__builder_8hpp_source_l00155}00155\ \}}

\end{DoxyCode}
