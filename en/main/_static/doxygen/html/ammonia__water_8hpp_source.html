<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>teqp: include/teqp/models/ammonia_water.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  loader: {
    load: ['[tex]/autoload']
  },
  tex: {
    macros: {    deriv: ["{\\left(\\frac{\\partial #1}{\\partial #2}\\right)_{#3}}",3],
    },
    packages: ['base','configmacros','newcommand','autoload']
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">teqp<span id="projectnumber">&#160;0.14.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_3db4b25fbe33360eb6f2cd11f794cfaa.html">teqp</a></li><li class="navelem"><a class="el" href="dir_79511ef0b920d6c788bd287ec259c9fc.html">models</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">ammonia_water.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="ammonia__water_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;Eigen/Dense&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &quot;<a class="code" href="multifluid_8hpp.html">teqp/models/multifluid.hpp</a>&quot;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceteqp.html">teqp</a>{</div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span>    <span class="keyword">class </span>AmmoniaWaterTillnerRoth {</div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span>        <span class="comment">// The EOS are hard-coded to make sure they cannot be changed</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>        <span class="keyword">const</span> nlohmann::json water_Wagner = nlohmann::json::parse(R<span class="stringliteral">&quot;delim(</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="stringliteral">            {&quot;ANCILLARIES&quot;: {&quot;melting_line&quot;: {&quot;BibTeX&quot;: &quot;IAPWS-Melting-2011&quot;, &quot;T_m&quot;: -1, &quot;parts&quot;: [{&quot;T_0&quot;: 273.16, &quot;T_max&quot;: 251.165, &quot;T_min&quot;: 273.16, &quot;a&quot;: [-1195393.37, -80818.3159, -3338.2686], &quot;p_0&quot;: 611.657, &quot;t&quot;: [3.0, 25.75, 103.75]}, {&quot;T_0&quot;: 251.165, &quot;T_max&quot;: 256.164, &quot;T_min&quot;: 251.165, &quot;a&quot;: [0.299948], &quot;p_0&quot;: 208566000.0, &quot;t&quot;: [60]}, {&quot;T_0&quot;: 256.164, &quot;T_max&quot;: 273.31, &quot;T_min&quot;: 256.164, &quot;a&quot;: [1.18721], &quot;p_0&quot;: 350100000.0, &quot;t&quot;: [8]}, {&quot;T_0&quot;: 273.31, &quot;T_max&quot;: 355, &quot;T_min&quot;: 273.31, &quot;a&quot;: [1.07476], &quot;p_0&quot;: 623400000.0, &quot;t&quot;: [4.6]}], &quot;type&quot;: &quot;polynomial_in_Tr&quot;}, &quot;pS&quot;: {&quot;T_r&quot;: 647.096, &quot;Tmax&quot;: 647.0959999999985, &quot;Tmin&quot;: 273.16, &quot;description&quot;: &quot;p&#39;&#39; = pc*exp(Tc/T*sum(n_i*theta^t_i))&quot;, &quot;max_abserror_percentage&quot;: 0.01384518934277601, &quot;n&quot;: [-9.75639641045262, 3.3357600887120102, -1.10029278432831, 0.02037617155190105, -2.6668589845604367, 6.676721087238668], &quot;reducing_value&quot;: 22064000.0, &quot;t&quot;: [1.018, 1.206, 2.327, 5.753, 4.215, 14.951], &quot;type&quot;: &quot;pV&quot;, &quot;using_tau_r&quot;: true}, &quot;rhoL&quot;: {&quot;T_r&quot;: 647.096, &quot;Tmax&quot;: 647.0959999999985, &quot;Tmin&quot;: 273.16, &quot;description&quot;: &quot;rho&#39; = rhoc*(1+sum(n_i*theta^t_i))&quot;, &quot;max_abserror_percentage&quot;: 0.14434134863475778, &quot;n&quot;: [0.8157021355019343, 2.0434712177006693, -78.58278372496308, 1026.4273940070307, -2290.5642779377695, 8420.141408210317], &quot;reducing_value&quot;: 17873.72799560906, &quot;t&quot;: [0.276, 0.455, 7.127, 9.846, 11.707, 17.805], &quot;type&quot;: &quot;rhoLnoexp&quot;, &quot;using_tau_r&quot;: false}, &quot;rhoV&quot;: {&quot;T_r&quot;: 647.096, &quot;Tmax&quot;: 647.0959999999985, &quot;Tmin&quot;: 273.16, &quot;description&quot;: &quot;rho&#39;&#39; = rhoc*exp(Tc/T*sum(n_i*theta^t_i))&quot;, &quot;max_abserror_percentage&quot;: 0.2457203054771817, &quot;n&quot;: [0.9791749335365787, -2.6190679042770215, -3.9166443712365235, -20.313306821636637, 16.497589490043744, -125.36580458432083], &quot;reducing_value&quot;: 17873.72799560906, &quot;t&quot;: [0.21, 0.262, 0.701, 3.909, 4.076, 17.459], &quot;type&quot;: &quot;rhoV&quot;, &quot;using_tau_r&quot;: true}, &quot;surface_tension&quot;: {&quot;BibTeX&quot;: &quot;Mulero-JPCRD-2012&quot;, &quot;Tc&quot;: 647.096, &quot;a&quot;: [-0.1306, 0.2151], &quot;description&quot;: &quot;sigma = sum(a_i*(1-T/Tc)^n_i)&quot;, &quot;n&quot;: [2.471, 1.233]}}, &quot;EOS&quot;: [{&quot;BibTeX_CP0&quot;: &quot;&quot;, &quot;BibTeX_EOS&quot;: &quot;Wagner-JPCRD-2002&quot;, &quot;STATES&quot;: {&quot;hs_anchor&quot;: {&quot;T&quot;: 711.8056, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 43781.065905123054, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 38398578.56983617, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 16086.355196048155, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: 87.17706239787964, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}, &quot;reducing&quot;: {&quot;T&quot;: 647.096, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 37556.74658424395, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 22064000, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 17873.72799560906, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: 79.4039479748897, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}, &quot;sat_min_liquid&quot;: {&quot;T&quot;: 273.16, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 0.011021389918129065, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 611.6548008968684, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 55496.95513999978, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: -6.248886779394275e-11, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}, &quot;sat_min_vapor&quot;: {&quot;T&quot;: 273.16, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 45054.657349954025, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 611.6548008968684, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 0.2694716052752858, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: 164.93862020846, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}}, &quot;T_max&quot;: 2000, &quot;T_max_units&quot;: &quot;K&quot;, &quot;Ttriple&quot;: 273.16, &quot;Ttriple_units&quot;: &quot;K&quot;, &quot;acentric&quot;: 0.3442920843, &quot;acentric_units&quot;: &quot;-&quot;, &quot;alpha0&quot;: [{&quot;a1&quot;: -8.3204464837497, &quot;a2&quot;: 6.6832105275932, &quot;type&quot;: &quot;IdealGasHelmholtzLead&quot;}, {&quot;a&quot;: 3.00632, &quot;type&quot;: &quot;IdealGasHelmholtzLogTau&quot;}, {&quot;n&quot;: [0.012436, 0.97315, 1.2795, 0.96956, 0.24873], &quot;t&quot;: [1.28728967, 3.53734222, 7.74073708, 9.24437796, 27.5075105], &quot;type&quot;: &quot;IdealGasHelmholtzPlanckEinstein&quot;}], &quot;alphar&quot;: [{&quot;d&quot;: [1, 1, 1, 2, 2, 3, 4, 1, 1, 1, 2, 2, 3, 4, 4, 5, 7, 9, 10, 11, 13, 15, 1, 2, 2, 2, 3, 4, 4, 4, 5, 6, 6, 7, 9, 9, 9, 9, 9, 10, 10, 12, 3, 4, 4, 5, 14, 3, 6, 6, 6], &quot;l&quot;: [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 4, 6, 6, 6, 6], &quot;n&quot;: [0.012533547935523, 7.8957634722828, -8.7803203303561, 0.31802509345418, -0.26145533859358, -0.0078199751687981, 0.0088089493102134, -0.66856572307965, 0.20433810950965, -6.6212605039687e-05, -0.19232721156002, -0.25709043003438, 0.16074868486251, -0.040092828925807, 3.9343422603254e-07, -7.5941377088144e-06, 0.00056250979351888, -1.5608652257135e-05, 1.1537996422951e-09, 3.6582165144204e-07, -1.3251180074668e-12, -6.2639586912454e-10, -0.10793600908932, 0.017611491008752, 0.22132295167546, -0.40247669763528, 0.58083399985759, 0.0049969146990806, -0.031358700712549, -0.74315929710341, 0.4780732991548, 0.020527940895948, -0.13636435110343, 0.014180634400617, 0.0083326504880713, -0.029052336009585, 0.038615085574206, -0.020393486513704, -0.0016554050063734, 0.0019955571979541, 0.00015870308324157, -1.638856834253e-05, 0.043613615723811, 0.034994005463765, -0.076788197844621, 0.022446277332006, -6.2689710414685e-05, -5.5711118565645e-10, -0.19905718354408, 0.31777497330738, -0.11841182425981], &quot;t&quot;: [-0.5, 0.875, 1, 0.5, 0.75, 0.375, 1, 4, 6, 12, 1, 5, 4, 2, 13, 9, 3, 4, 11, 4, 13, 1, 7, 1, 9, 10, 10, 3, 7, 10, 10, 6, 10, 10, 1, 2, 3, 4, 8, 6, 9, 8, 16, 22, 23, 23, 10, 50, 44, 46, 50], &quot;type&quot;: &quot;ResidualHelmholtzPower&quot;}, {&quot;beta&quot;: [150, 150, 250], &quot;d&quot;: [3, 3, 3], &quot;epsilon&quot;: [1, 1, 1], &quot;eta&quot;: [20, 20, 20], &quot;gamma&quot;: [1.21, 1.21, 1.25], &quot;n&quot;: [-31.306260323435, 31.546140237781, -2521.3154341695], &quot;t&quot;: [0, 1, 4], &quot;type&quot;: &quot;ResidualHelmholtzGaussian&quot;}, {&quot;A&quot;: [0.32, 0.32], &quot;B&quot;: [0.2, 0.2], &quot;C&quot;: [28, 32], &quot;D&quot;: [700, 800], &quot;a&quot;: [3.5, 3.5], &quot;b&quot;: [0.85, 0.95], &quot;beta&quot;: [0.3, 0.3], &quot;n&quot;: [-0.14874640856724, 0.31806110878444], &quot;type&quot;: &quot;ResidualHelmholtzNonAnalytic&quot;}], &quot;critical_region_splines&quot;: {&quot;T_max&quot;: 647.096, &quot;T_min&quot;: 647.0954167354802, &quot;_note&quot;: &quot;Coefficients for the critical cubic spline.  T = c[0]*rho^3 + c[1]*rho^2 + c[2]*rho + c[3] with rho in mol/m^3 and T in K&quot;, &quot;cL&quot;: [0.0, 0.0, -2.6319631259532804e-06, 647.1430429930077], &quot;cV&quot;: [0.0, 0.0, 2.6053577217441603e-06, 647.0494325447503], &quot;rhomolar_max&quot;: 18095.336161027783, &quot;rhomolar_min&quot;: 17649.856810851063}, &quot;gas_constant&quot;: 8.314371357587, &quot;gas_constant_units&quot;: &quot;J/mol/K&quot;, &quot;molar_mass&quot;: 0.018015268, &quot;molar_mass_units&quot;: &quot;kg/mol&quot;, &quot;p_max&quot;: 1000000000, &quot;p_max_units&quot;: &quot;Pa&quot;, &quot;pseudo_pure&quot;: false}], &quot;INFO&quot;: {&quot;2DPNG_URL&quot;: &quot;http://www.chemspider.com/ImagesHandler.ashx?id=937&quot;, &quot;ALIASES&quot;: [&quot;water&quot;, &quot;WATER&quot;, &quot;H2O&quot;, &quot;h2o&quot;, &quot;R718&quot;], &quot;CAS&quot;: &quot;7732-18-5&quot;, &quot;CHEMSPIDER_ID&quot;: 937, &quot;ENVIRONMENTAL&quot;: {&quot;ASHRAE34&quot;: &quot;A1&quot;, &quot;FH&quot;: 0, &quot;GWP100&quot;: -1.0, &quot;GWP20&quot;: -1.0, &quot;GWP500&quot;: -1.0, &quot;HH&quot;: 0, &quot;Name&quot;: &quot;Water&quot;, &quot;ODP&quot;: -1.0, &quot;PH&quot;: 0}, &quot;FORMULA&quot;: &quot;H_{2}O_{1}&quot;, &quot;INCHI_KEY&quot;: &quot;XLYOFNOQVPJJNP-UHFFFAOYSA-N&quot;, &quot;INCHI_STRING&quot;: &quot;InChI=1S/H2O/h1H2&quot;, &quot;NAME&quot;: &quot;Water&quot;, &quot;REFPROP_NAME&quot;: &quot;WATER&quot;, &quot;SMILES&quot;: &quot;O&quot;}, &quot;STATES&quot;: {&quot;critical&quot;: {&quot;T&quot;: 647.096, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 37549.461223920865, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 22064000.0, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 17873.72799560906, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: 79.3940358438747, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}, &quot;triple_liquid&quot;: {&quot;T&quot;: 273.16, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 0.011021389918129065, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 611.6548008968684, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 55496.95513999978, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: -6.248886779394275e-11, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}, &quot;triple_vapor&quot;: {&quot;T&quot;: 273.16, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 45054.657349954025, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 611.6548008968684, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 0.2694716052752858, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: 164.93862020846, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}}}</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="stringliteral">        )delim&quot;);</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="stringliteral">        </span><span class="keyword">const</span> nlohmann::json ammonia_TillnerRoth = nlohmann::json::parse(R<span class="stringliteral">&quot;delim(</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="stringliteral">            {&quot;ANCILLARIES&quot;: {&quot;pS&quot;: {&quot;T_r&quot;: 405.4, &quot;Tmax&quot;: 405.39999999999924, &quot;Tmin&quot;: 195.495, &quot;description&quot;: &quot;p&#39;&#39; = pc*exp(Tc/T*sum(n_i*theta^t_i))&quot;, &quot;max_abserror_percentage&quot;: 0.05181632089212851, &quot;n&quot;: [0.0016131703802769548, 0.01339903644956835, -6.4517151211338994, -4.349105787320862, 1.8295554336003688, 7.011533373126273], &quot;reducing_value&quot;: 11333000.0, &quot;t&quot;: [0.108, 0.435, 0.971, 4.023, 4.944, 17.494], &quot;type&quot;: &quot;pV&quot;, &quot;using_tau_r&quot;: true}, &quot;rhoL&quot;: {&quot;T_r&quot;: 405.4, &quot;Tmax&quot;: 405.39999999999924, &quot;Tmin&quot;: 195.495, &quot;description&quot;: &quot;rho&#39; = rhoc*(1+sum(n_i*theta^t_i))&quot;, &quot;max_abserror_percentage&quot;: 0.8982235822398099, &quot;n&quot;: [0.6217530323464998, 116.65648581323893, -116.06575843470785, 2.722640286484237, -2.6080795358675433, 18.393705416728867], &quot;reducing_value&quot;: 13211.777154312385, &quot;t&quot;: [0.217, 0.713, 0.724, 1.557, 3.994, 9.339], &quot;type&quot;: &quot;rhoLnoexp&quot;, &quot;using_tau_r&quot;: false}, &quot;rhoV&quot;: {&quot;T_r&quot;: 405.4, &quot;Tmax&quot;: 405.39999999999924, &quot;Tmin&quot;: 195.495, &quot;description&quot;: &quot;rho&#39;&#39; = rhoc*exp(Tc/T*sum(n_i*theta^t_i))&quot;, &quot;max_abserror_percentage&quot;: 0.802513430755436, &quot;n&quot;: [1.2911157089516188, -1.4201786958021996, -145.4871281248165, 140.71212306607288, -3.147462914747211, -0.9907144617787934], &quot;reducing_value&quot;: 13211.777154312385, &quot;t&quot;: [0.037, 0.04, 0.584, 0.585, 2.858, 6.099], &quot;type&quot;: &quot;rhoV&quot;, &quot;using_tau_r&quot;: true}, &quot;surface_tension&quot;: {&quot;BibTeX&quot;: &quot;Mulero-JPCRD-2012&quot;, &quot;Tc&quot;: 405.4, &quot;a&quot;: [0.1028, -0.09453], &quot;description&quot;: &quot;sigma = sum(a_i*(1-T/Tc)^n_i)&quot;, &quot;n&quot;: [1.211, 5.585]}}, &quot;EOS&quot;: [{&quot;BibTeX_CP0&quot;: &quot;&quot;, &quot;BibTeX_EOS&quot;: &quot;TillnerRoth-DKV-1993&quot;, &quot;STATES&quot;: {&quot;hs_anchor&quot;: {&quot;T&quot;: 445.94, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 25012.280343289814, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 18635643.933141705, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 11890.599438881152, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: 75.46262589632495, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}, &quot;reducing&quot;: {&quot;T&quot;: 405.4, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 21501.16668203028, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 11333000, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 13211.77715431239, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: 68.56438502935785, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}, &quot;sat_min_liquid&quot;: {&quot;T&quot;: 195.495, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 0.14111811220522047, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 6091.2231081315085, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 43035.33929207322, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: -1.9440525067083775e-06, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}, &quot;sat_min_vapor&quot;: {&quot;T&quot;: 195.495, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 25279.492873914965, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 6091.223108650368, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 3.763506027681136, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: 129.30945229032756, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}}, &quot;T_max&quot;: 700, &quot;T_max_units&quot;: &quot;K&quot;, &quot;Ttriple&quot;: 195.495, &quot;Ttriple_units&quot;: &quot;K&quot;, &quot;acentric&quot;: 0.25601, &quot;acentric_units&quot;: &quot;-&quot;, &quot;alpha0&quot;: [{&quot;a1&quot;: -15.81502, &quot;a2&quot;: 4.255726, &quot;type&quot;: &quot;IdealGasHelmholtzLead&quot;}, {&quot;a&quot;: -1, &quot;type&quot;: &quot;IdealGasHelmholtzLogTau&quot;}, {&quot;n&quot;: [11.47434, -1.296211, 0.5706757], &quot;t&quot;: [0.3333333333333333, -1.5, -1.75], &quot;type&quot;: &quot;IdealGasHelmholtzPower&quot;}, {&quot;a1&quot;: -0.965940085369186, &quot;a2&quot;: 0.723282863334932, &quot;reference&quot;: &quot;OTH&quot;, &quot;type&quot;: &quot;IdealGasHelmholtzEnthalpyEntropyOffset&quot;}], &quot;alphar&quot;: [{&quot;d&quot;: [2, 1, 4, 1, 15, 3, 3, 1, 8, 2, 1, 8, 1, 2, 3, 2, 4, 3, 1, 2, 4], &quot;l&quot;: [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3], &quot;n&quot;: [0.04554431, 0.7238548, 0.0122947, -1.858814, 2.141882e-11, -0.0143002, 0.3441324, -0.2873571, 2.352589e-05, -0.03497111, 0.02397852, 0.001831117, -0.04085375, 0.2379275, -0.03548972, -0.1823729, 0.02281556, -0.006663444, -0.008847486, 0.002272635, -0.0005588655], &quot;t&quot;: [-0.5, 0.5, 1, 1.5, 3, 0, 3, 4, 4, 5, 3, 5, 6, 8, 8, 10, 10, 5, 7.5, 15, 30], &quot;type&quot;: &quot;ResidualHelmholtzPower&quot;}], &quot;gas_constant&quot;: 8.314471, &quot;gas_constant_units&quot;: &quot;J/mol/K&quot;, &quot;molar_mass&quot;: 0.01703026, &quot;molar_mass_units&quot;: &quot;kg/mol&quot;, &quot;p_max&quot;: 1000000000, &quot;p_max_units&quot;: &quot;Pa&quot;, &quot;pseudo_pure&quot;: false}], &quot;INFO&quot;: {&quot;2DPNG_URL&quot;: &quot;http://www.chemspider.com/ImagesHandler.ashx?id=217&quot;, &quot;ALIASES&quot;: [&quot;NH3&quot;, &quot;ammonia&quot;, &quot;R717&quot;, &quot;AMMONIA&quot;], &quot;CAS&quot;: &quot;7664-41-7&quot;, &quot;CHEMSPIDER_ID&quot;: 217, &quot;ENVIRONMENTAL&quot;: {&quot;ASHRAE34&quot;: &quot;B2&quot;, &quot;FH&quot;: 1, &quot;GWP100&quot;: -1.0, &quot;GWP20&quot;: -1.0, &quot;GWP500&quot;: -1.0, &quot;HH&quot;: 3, &quot;Name&quot;: &quot;Ammonia&quot;, &quot;ODP&quot;: -1.0, &quot;PH&quot;: 0}, &quot;FORMULA&quot;: &quot;H_{3}N_{1}&quot;, &quot;INCHI_KEY&quot;: &quot;QGZKDVFQNNGYKY-UHFFFAOYSA-N&quot;, &quot;INCHI_STRING&quot;: &quot;InChI=1S/H3N/h1H3&quot;, &quot;NAME&quot;: &quot;Ammonia&quot;, &quot;REFPROP_NAME&quot;: &quot;AMMONIA&quot;, &quot;SMILES&quot;: &quot;N&quot;}, &quot;STATES&quot;: {&quot;critical&quot;: {&quot;T&quot;: 405.56, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 21501.16668203028, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 11363400, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 13696, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: 68.56438502935785, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}, &quot;triple_liquid&quot;: {&quot;T&quot;: 195.495, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 0.14111811220522047, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 6091.2231081315085, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 43035.33929207322, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: -1.9440525067083775e-06, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}, &quot;triple_vapor&quot;: {&quot;T&quot;: 195.495, &quot;T_units&quot;: &quot;K&quot;, &quot;hmolar&quot;: 25279.492873914965, &quot;hmolar_units&quot;: &quot;J/mol&quot;, &quot;p&quot;: 6091.223108650368, &quot;p_units&quot;: &quot;Pa&quot;, &quot;rhomolar&quot;: 3.763506027681136, &quot;rhomolar_units&quot;: &quot;mol/m^3&quot;, &quot;smolar&quot;: 129.30945229032756, &quot;smolar_units&quot;: &quot;J/mol/K&quot;}}}</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="stringliteral">        )delim&quot;);</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="stringliteral">        </span><span class="keyword">const</span> Eigen::ArrayXd a = (Eigen::ArrayXd(15) &lt;&lt; 0,-1.855822E-02,5.258010E-02,3.552874E-10,5.451379E-06,-5.998546E-13,-3.687808E-06,0.2586192,-1.368072E-08,1.226146E-02,-7.181443E-02,9.970849E-02,1.0584086E-03,-0.1963687,-0.7777897).finished();</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>        <span class="keyword">const</span> Eigen::ArrayXd t = (Eigen::ArrayXd(15) &lt;&lt; 0,1.5,0.5,6.5,1.75,15,6,-1,4,3.5,0,-1,8,7.5,4).finished();</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>        <span class="keyword">const</span> Eigen::ArrayXd d = (Eigen::ArrayXd(15) &lt;&lt; 0,4,5,15,12,12,15,4,15,4,5,6,10,6,2).finished();</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>        <span class="keyword">const</span> Eigen::ArrayXd e = (Eigen::ArrayXd(15) &lt;&lt; 0,0,1,1,1,1,2,1,1,1,1,2,2,2,2).finished();</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>        <span class="keyword">const</span> std::vector&lt;teqp::EOSTerms&gt; pures;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> TcNH3 = 405.40, TcH2O = 647.096, k_T = 0.9648407, alpha = 1.125455;</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> vcNH3 = 0.01703026/225, vcH2O = 0.018015268/322, k_V = 1.2395117, beta = 0.8978069;</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>        AmmoniaWaterTillnerRoth() : pures(<a class="code hl_function" href="namespaceteqp.html#a427e105aec20374b74c7bef742ac5277">get_EOSs</a>({ ammonia_TillnerRoth, water_Wagner })) {};</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>        <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MoleFracType&gt;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>        <span class="keyword">auto</span> R(<span class="keyword">const</span> MoleFracType&amp;)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 8.314471; }</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>        <span class="keyword">template</span>&lt;<span class="keyword">typename</span> TType, <span class="keyword">typename</span> RhoType, <span class="keyword">typename</span> MoleFracType&gt;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>        <span class="keyword">auto</span> alphar_departure(<span class="keyword">const</span> TType&amp; tau, <span class="keyword">const</span> RhoType&amp; delta, <span class="keyword">const</span> MoleFracType&amp; xNH3)<span class="keyword"> const</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>            std::common_type_t&lt;TType, RhoType, MoleFracType&gt; summer = a[1]*<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(tau, t[1])*<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(delta, d[1]);</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> i=2; i &lt;= 6; ++i){ summer = summer + a[i]*<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(tau, t[i])*<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(delta, d[i])*exp(-<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(delta,e[i]));}</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> i=7; i &lt;= 13; ++i){ summer = summer + xNH3*a[i]*<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(tau, t[i])*<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(delta, d[i])*exp(-<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(delta,e[i]));}</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> i=14; i &lt;= 14; ++i) { summer = summer + xNH3*xNH3 * a[i] * <a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(tau, t[i]) * <a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(delta, d[i]) * exp(-<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(delta, e[i])); }</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>            <span class="keywordtype">double</span> gamma = 0.5248379;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>            <span class="comment">// xNH3^gamma is not differentiable at xNH3=0, but limit when multiplied by zero is still zero</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceteqp.html#a79c1a1ea4876acd80e74721bba2361ce">getbaseval</a>(xNH3) == 0) {</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>                <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>decltype(summer)<span class="keyword">&gt;</span>(0.0);</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>            }</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespaceteqp.html#adc93f32478a2bc846371e04d6b5ac726">forceeval</a>(xNH3 * (1 - <a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(xNH3, gamma)) * summer);</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>        }</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>        </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MoleFracType&gt;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>        <span class="keyword">auto</span> get_Treducing(<span class="keyword">const</span> MoleFracType&amp; molefrac)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>            <span class="keywordflow">if</span> (molefrac.size() != 2) {</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>                <span class="keywordflow">throw</span> <a class="code hl_class" href="classteqp_1_1InvalidArgument.html">teqp::InvalidArgument</a>(<span class="stringliteral">&quot;Wrong size of molefrac, should be 2&quot;</span>);</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>            }</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>            <span class="keyword">auto</span> xNH3 = molefrac[0];</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceteqp.html#a79c1a1ea4876acd80e74721bba2361ce">getbaseval</a>(xNH3) == 0) {</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>                <span class="keywordflow">throw</span> <a class="code hl_class" href="classteqp_1_1InvalidArgument.html">teqp::InvalidArgument</a>(<span class="stringliteral">&quot;Tillner-Roth model cannot accept mole fraction of zero&quot;</span>);</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>                <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>decltype(xNH3)<span class="keyword">&gt;</span>(TcH2O);</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>            }</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>            <span class="keyword">auto</span> Tred = <a class="code hl_function" href="namespaceteqp.html#adc93f32478a2bc846371e04d6b5ac726">forceeval</a>(TcNH3*xNH3*xNH3 + TcH2O*(1-xNH3)*(1-xNH3) + 2.0*xNH3*(1.0-<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(xNH3, alpha))*k_T/2.0*(TcNH3 + TcH2O));</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>            <span class="keywordflow">return</span> Tred;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>        }</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        <span class="keyword">template</span>&lt;<span class="keyword">typename</span> MoleFracType&gt;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>        <span class="keyword">auto</span> get_rhoreducing(<span class="keyword">const</span> MoleFracType&amp; molefrac)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>            <span class="keywordflow">if</span> (molefrac.size() != 2) {</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>                <span class="keywordflow">throw</span> <a class="code hl_class" href="classteqp_1_1InvalidArgument.html">teqp::InvalidArgument</a>(<span class="stringliteral">&quot;Wrong size of molefrac, should be 2&quot;</span>);</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>            }</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>            <span class="keyword">auto</span> xNH3 = molefrac[0];</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceteqp.html#a79c1a1ea4876acd80e74721bba2361ce">getbaseval</a>(xNH3) == 0) {</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>                <span class="keywordflow">throw</span> <a class="code hl_class" href="classteqp_1_1InvalidArgument.html">teqp::InvalidArgument</a>(<span class="stringliteral">&quot;Tillner-Roth model cannot accept mole fraction of zero&quot;</span>);</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>                <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>decltype(xNH3)<span class="keyword">&gt;</span>(<a class="code hl_function" href="namespaceteqp.html#adc93f32478a2bc846371e04d6b5ac726">forceeval</a>(1/vcH2O));</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>            }</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>            <span class="keyword">auto</span> vred = <a class="code hl_function" href="namespaceteqp.html#adc93f32478a2bc846371e04d6b5ac726">forceeval</a>(vcNH3*xNH3*xNH3 + vcH2O*(1-xNH3)*(1-xNH3) + 2.0*xNH3*(1.0-<a class="code hl_function" href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">pow</a>(xNH3, beta))*k_V/2.0*(vcNH3 + vcH2O));</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespaceteqp.html#adc93f32478a2bc846371e04d6b5ac726">forceeval</a>(1/vred);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        }</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        <span class="keyword">template</span>&lt;<span class="keyword">typename</span> TType, <span class="keyword">typename</span> RhoType, <span class="keyword">typename</span> MoleFracType&gt;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        <span class="keyword">auto</span> alphar(<span class="keyword">const</span> TType&amp; T,</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>            <span class="keyword">const</span> RhoType&amp; rho,</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>            <span class="keyword">const</span> MoleFracType&amp; molefrac)<span class="keyword"> const</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            <span class="keywordflow">if</span> (molefrac.size() != 2) {</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>                <span class="keywordflow">throw</span> <a class="code hl_class" href="classteqp_1_1InvalidArgument.html">teqp::InvalidArgument</a>(<span class="stringliteral">&quot;Wrong size of molefrac, should be 2&quot;</span>);</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>            }</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            <span class="keyword">auto</span> xNH3 = molefrac[0];</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>            <span class="keyword">auto</span> Tred = get_Treducing(molefrac);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>            <span class="keyword">auto</span> rhored = get_rhoreducing(molefrac);</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>            <span class="keyword">auto</span> delta = <a class="code hl_function" href="namespaceteqp.html#adc93f32478a2bc846371e04d6b5ac726">forceeval</a>(rho / rhored);</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>            <span class="keyword">auto</span> tau = <a class="code hl_function" href="namespaceteqp.html#adc93f32478a2bc846371e04d6b5ac726">forceeval</a>(Tred / T);</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>            <span class="keyword">auto</span> val_CS = pures[0].alphar(tau, delta)*xNH3 + pures[1].alphar(tau, delta)*(1-xNH3);</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>            <span class="keyword">auto</span> val_dep = alphar_departure(tau, delta, xNH3);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespaceteqp.html#adc93f32478a2bc846371e04d6b5ac726">forceeval</a>(val_CS + val_dep);</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        }</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    };</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>} <span class="comment">/* */</span></div>
<div class="ttc" id="aclassteqp_1_1InvalidArgument_html"><div class="ttname"><a href="classteqp_1_1InvalidArgument.html">teqp::InvalidArgument</a></div><div class="ttdef"><b>Definition</b> <a href="exceptions_8hpp_source.html#l00029">exceptions.hpp:29</a></div></div>
<div class="ttc" id="amultifluid_8hpp_html"><div class="ttname"><a href="multifluid_8hpp.html">multifluid.hpp</a></div></div>
<div class="ttc" id="anamespaceteqp_html"><div class="ttname"><a href="namespaceteqp.html">teqp</a></div><div class="ttdef"><b>Definition</b> <a href="ancillary__builder_8hpp_source.html#l00008">ancillary_builder.hpp:8</a></div></div>
<div class="ttc" id="anamespaceteqp_html_a427e105aec20374b74c7bef742ac5277"><div class="ttname"><a href="namespaceteqp.html#a427e105aec20374b74c7bef742ac5277">teqp::get_EOSs</a></div><div class="ttdeci">auto get_EOSs(const std::vector&lt; nlohmann::json &gt; &amp;pureJSON)</div><div class="ttdef"><b>Definition</b> <a href="multifluid_8hpp_source.html#l00716">multifluid.hpp:716</a></div></div>
<div class="ttc" id="anamespaceteqp_html_a79c1a1ea4876acd80e74721bba2361ce"><div class="ttname"><a href="namespaceteqp.html#a79c1a1ea4876acd80e74721bba2361ce">teqp::getbaseval</a></div><div class="ttdeci">auto getbaseval(const T &amp;expr)</div><div class="ttdef"><b>Definition</b> <a href="types_8hpp_source.html#l00084">types.hpp:84</a></div></div>
<div class="ttc" id="anamespaceteqp_html_ad47d847ff6ba42d73eb1ffc3fcf270c8"><div class="ttname"><a href="namespaceteqp.html#ad47d847ff6ba42d73eb1ffc3fcf270c8">teqp::pow</a></div><div class="ttdeci">auto pow(const double &amp;x, const double &amp;e)</div><div class="ttdef"><b>Definition</b> <a href="types_8hpp_source.html#l00189">types.hpp:189</a></div></div>
<div class="ttc" id="anamespaceteqp_html_adc93f32478a2bc846371e04d6b5ac726"><div class="ttname"><a href="namespaceteqp.html#adc93f32478a2bc846371e04d6b5ac726">teqp::forceeval</a></div><div class="ttdeci">auto forceeval(T &amp;&amp;expr)</div><div class="ttdef"><b>Definition</b> <a href="types_8hpp_source.html#l00046">types.hpp:46</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
